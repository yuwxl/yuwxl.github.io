

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/dog.jpg">
  <link rel="icon" href="/img/dog.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="nayun">
  <meta name="keywords" content="">
  
    <meta name="description" content="truffle 部署智能合约到ganache-cli测试链1.安装truffle1sudo npm install -g truffle 2.安装ganache-cli1npm install ganache-cli 3.开启ganache-cli测试链123456启动测试链：ganache-cli -d -h localhost:8545 &gt; ganache.log &amp;ganach">
<meta property="og:type" content="article">
<meta property="og:title" content="lab测试">
<meta property="og:url" content="https://yuwxl.github.io/2023/09/10/lab_test/index.html">
<meta property="og:site_name" content="yu&#39;s blog">
<meta property="og:description" content="truffle 部署智能合约到ganache-cli测试链1.安装truffle1sudo npm install -g truffle 2.安装ganache-cli1npm install ganache-cli 3.开启ganache-cli测试链123456启动测试链：ganache-cli -d -h localhost:8545 &gt; ganache.log &amp;ganach">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230910153212898.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230910152557622.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230910153433034.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230912162616416.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230915165435356.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230910153630153.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230910153711193.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230915190419636.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230910160309955.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230910160626788.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230910160746443.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230910160827758.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230910211339344.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230910211714219.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230913143429967.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230913143547150.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230913143355543.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230915190627452.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230918094108844.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230918094511111.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230918100015122.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230918100507264.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230918104923278.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20230918151851875.png">
<meta property="og:image" content="https://yuwxl.github.io/2023/09/10/images/lab_test/image-20231024142330189.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20231114110008995.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20231108102854718.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20231113150510081.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20231116150205735.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20231117103022766.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20231117125131907.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20231117144936021.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20231120154853899.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20231127200543999.png">
<meta property="og:image" content="https://yuwxl.github.io/images/lab_test/image-20231129101652934.png">
<meta property="article:published_time" content="2023-09-10T06:36:00.000Z">
<meta property="article:modified_time" content="2025-01-02T01:50:47.881Z">
<meta property="article:author" content="nayun">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://yuwxl.github.io/images/lab_test/image-20230910153212898.png">
  
  
  
  <title>lab测试 - yu&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"yuwxl.github.io","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>nana</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/tina.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="lab测试"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-09-10 14:36" pubdate>
          2023年9月10日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          53k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          445 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">lab测试</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="truffle-部署智能合约到ganache-cli测试链"><a href="#truffle-部署智能合约到ganache-cli测试链" class="headerlink" title="truffle 部署智能合约到ganache-cli测试链"></a>truffle 部署智能合约到ganache-cli测试链</h2><h5 id="1-安装truffle"><a href="#1-安装truffle" class="headerlink" title="1.安装truffle"></a>1.安装truffle</h5><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">sudo npm <span class="hljs-keyword">install</span> -g truffle<br></code></pre></td></tr></table></figure>
<h5 id="2-安装ganache-cli"><a href="#2-安装ganache-cli" class="headerlink" title="2.安装ganache-cli"></a>2.安装ganache-cli</h5><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">npm install ganache-<span class="hljs-keyword">cli</span><br></code></pre></td></tr></table></figure>
<h5 id="3-开启ganache-cli测试链"><a href="#3-开启ganache-cli测试链" class="headerlink" title="3.开启ganache-cli测试链"></a>3.开启ganache-cli测试链</h5><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs 1c">启动测试链：ganache-cli -d -h localhost:<span class="hljs-number">8545</span> &gt; ganache.<span class="hljs-built_in">log</span> <span class="hljs-meta">&amp;</span><br>ganache-cli -d -h <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">8545</span> &gt; ganache.<span class="hljs-built_in">log</span> <span class="hljs-meta">&amp;</span><br>ganache-cli &gt; ganache.<span class="hljs-built_in">log</span> <span class="hljs-meta">&amp;</span><br>查看测试链tail -f ganache.<span class="hljs-built_in">log</span><br>查看端口进程 lsof -i :<span class="hljs-number">8545</span><br>ganache-cli -p <span class="hljs-number">8546</span> &gt; ganache.<span class="hljs-built_in">log</span> <span class="hljs-meta">&amp;</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20230910153212898.png" srcset="/img/loading.gif" lazyload alt="image-20230910153212898"></p>
<h5 id="4-初始化truffle项目"><a href="#4-初始化truffle项目" class="headerlink" title="4.初始化truffle项目"></a>4.初始化truffle项目</h5><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">在项目根目录下<br>初始化：truffle init<br>.<br>├── contracts<br>├── migrations<br>├── test<br>└── truffle-<span class="hljs-built_in">config</span>.<span class="hljs-keyword">js</span><br><span class="hljs-keyword"></span><span class="hljs-number">3</span> <span class="hljs-keyword">directories, </span><span class="hljs-number">1</span> file<br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20230910152557622.png" srcset="/img/loading.gif" lazyload alt="image-20230910152557622"></p>
<h5 id="5-创建合约"><a href="#5-创建合约" class="headerlink" title="5.创建合约"></a>5.创建合约</h5><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">编写简单智能合约和测试代码<br>在项目根目录下的contracts目录中创建一个新的Solidity合约文件，例如SimpleStorage.sol，并添加以下内容：<br>// SimpleStorage.sol<br>// SPDX-License-Identifier: MIT<br>pragma solidity ^<span class="hljs-number">0.8</span><span class="hljs-number">.17</span>;<br><br>contract SimpleStorage &#123;<br>    uint256 <span class="hljs-built_in">public</span> storedData;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-keyword">set</span>(uint256 x) <span class="hljs-built_in">public</span> &#123;<br>        storedData = x;<br>    &#125;<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-keyword">get</span>() <span class="hljs-built_in">public</span> <span class="hljs-keyword">view</span> <span class="hljs-keyword">returns</span> (uint256) &#123;<br>        <span class="hljs-keyword">return</span> storedData;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<h5 id="6-创建一个合约迁移脚本"><a href="#6-创建一个合约迁移脚本" class="headerlink" title="6.创建一个合约迁移脚本"></a>6.创建一个合约迁移脚本</h5><p>在项目根目录下的<code>migrations</code>目录中创建一个新的迁移脚本，例如<code>2_deploy_simple_storage.js</code>，并添加以下内容：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript">javascriptCopy code<span class="hljs-comment">// 2_deploy_simple_storage.js</span><br><span class="hljs-keyword">const</span> SimpleStorage = artifacts.require(<span class="hljs-string">&quot;SimpleStorage&quot;</span>);<br><br><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">deployer</span>) </span>&#123;<br>  deployer.deploy(SimpleStorage);<br>&#125;;<br></code></pre></td></tr></table></figure>
<h5 id="7-部署合约到测试链"><a href="#7-部署合约到测试链" class="headerlink" title="7.部署合约到测试链"></a>7.部署合约到测试链</h5><p>（确保测试链处于运行状态，并且truffle-config.js内的网络配置正确连接到测试网）</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">部署：truffle migrate<br>truffle migrate <span class="hljs-comment">--to 2</span><br>truffle migrate <span class="hljs-comment">--reset --f 4 --to 4</span><br><br>truffle migrate <span class="hljs-comment">--f 2 --to 2</span><br>truffle-config.js<br> development: &#123;<br>     host: &quot;127.0.0.1&quot;,     // Localhost (<span class="hljs-keyword">default</span>: <span class="hljs-keyword">none</span>)<br>     port: <span class="hljs-number">8545</span>,            // Standard Ethereum port (<span class="hljs-keyword">default</span>: <span class="hljs-keyword">none</span>)<br>     network_id: &quot;*&quot;,       // <span class="hljs-keyword">Any</span> network (<span class="hljs-keyword">default</span>: <span class="hljs-keyword">none</span>)<br>    &#125;<br>    ../../coordinator/build/SimpleStorage.json<br>        let contract_address = Address::from_str(&quot;0x10fB2Ab116E2Eb3a8B5a1Ca912E05f63c3D969E4&quot;)?;<br>    let contract_abi = include_bytes!(&quot;SimpleStorage.json&quot;);<br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20230910153433034.png" srcset="/img/loading.gif" lazyload alt="image-20230910153433034"></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs csharp">查看已部署合约:<br>进入控制台：<span class="hljs-function">truffle console</span><br><span class="hljs-function"><span class="hljs-title">truffle</span>(<span class="hljs-params">development</span>)&gt; <span class="hljs-keyword">let</span> instance</span> = <span class="hljs-keyword">await</span> TexasHoldemPoker.deployed();<br>truffle(development)&gt; instance2.address<br><span class="hljs-keyword">let</span> instance2 = <span class="hljs-keyword">await</span> COORDINATOR.deployed()<br><span class="hljs-keyword">await</span> instance.<span class="hljs-keyword">set</span>(<span class="hljs-number">1234</span>); <span class="hljs-comment">//调用合约</span><br><span class="hljs-keyword">await</span> instance.<span class="hljs-keyword">get</span>();<br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20230912162616416.png" srcset="/img/loading.gif" lazyload alt="image-20230912162616416"></p>
<p><img src="/images/lab_test/image-20230915165435356.png" srcset="/img/loading.gif" lazyload alt="image-20230915165435356"></p>
<h5 id="8-编写性能测试脚本"><a href="#8-编写性能测试脚本" class="headerlink" title="8.编写性能测试脚本"></a>8.编写性能测试脚本</h5><p>在项目根目录中创建一个新的JavaScript文件，例如<code>performance_test.js</code>，并添加以下内容：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs javascript">javascriptCopy code<span class="hljs-comment">// performance_test.js</span><br><span class="hljs-keyword">const</span> SimpleStorage = artifacts.require(<span class="hljs-string">&quot;SimpleStorage&quot;</span>);<br><br>contract(<span class="hljs-string">&quot;SimpleStorage&quot;</span>, <span class="hljs-keyword">async</span> (accounts) =&gt; &#123;<br>  <span class="hljs-keyword">let</span> simpleStorageInstance;<br><br>  before(<span class="hljs-keyword">async</span> () =&gt; &#123;<br>    simpleStorageInstance = <span class="hljs-keyword">await</span> SimpleStorage.deployed();<br>  &#125;);<br><br>  it(<span class="hljs-string">&quot;should measure throughput and latency&quot;</span>, <span class="hljs-keyword">async</span> () =&gt; &#123;<br>    <span class="hljs-comment">// Measure throughput</span><br>    <span class="hljs-keyword">const</span> startTimestamp = <span class="hljs-built_in">Date</span>.now();<br>    <span class="hljs-keyword">const</span> numberOfTransactions = <span class="hljs-number">100</span>; <span class="hljs-comment">// Change this to the desired number of transactions</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; numberOfTransactions; i++) &#123;<br>      <span class="hljs-keyword">await</span> simpleStorageInstance.set(i, &#123; <span class="hljs-attr">from</span>: accounts[<span class="hljs-number">0</span>] &#125;);<br>    &#125;<br>    <span class="hljs-keyword">const</span> endTimestamp = <span class="hljs-built_in">Date</span>.now();<br>    <span class="hljs-keyword">const</span> elapsedSeconds = (endTimestamp - startTimestamp) / <span class="hljs-number">1000</span>;<br>    <span class="hljs-keyword">const</span> throughput = numberOfTransactions / elapsedSeconds;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Throughput: <span class="hljs-subst">$&#123;throughput&#125;</span> transactions per second`</span>);<br><br>    <span class="hljs-comment">// Measure latency</span><br>    <span class="hljs-keyword">const</span> latencyStartTimestamp = <span class="hljs-built_in">Date</span>.now();<br>    <span class="hljs-keyword">await</span> simpleStorageInstance.set(numberOfTransactions, &#123; <span class="hljs-attr">from</span>: accounts[<span class="hljs-number">0</span>] &#125;);<br>    <span class="hljs-keyword">const</span> latencyEndTimestamp = <span class="hljs-built_in">Date</span>.now();<br>    <span class="hljs-keyword">const</span> latency = latencyEndTimestamp - latencyStartTimestamp;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Latency: <span class="hljs-subst">$&#123;latency&#125;</span> milliseconds`</span>);<br>  &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure>
<h5 id="9-运行性能测试"><a href="#9-运行性能测试" class="headerlink" title="9.运行性能测试"></a>9.运行性能测试</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">truffle <span class="hljs-built_in">test</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20230910153630153.png" srcset="/img/loading.gif" lazyload alt="image-20230910153630153"></p>
<h5 id="10-此过程中ganache-log持续写入日志"><a href="#10-此过程中ganache-log持续写入日志" class="headerlink" title="10.此过程中ganache.log持续写入日志"></a>10.此过程中ganache.log持续写入日志</h5><p><img src="/images/lab_test/image-20230910153711193.png" srcset="/img/loading.gif" lazyload alt="image-20230910153711193"></p>
<h5 id="11-用ethers-js与合约交互"><a href="#11-用ethers-js与合约交互" class="headerlink" title="11.用ethers.js与合约交互"></a>11.用ethers.js与合约交互</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs javascript">安装npm install truffle-assertions<br>安装 npm install ethers<br><br>编写交互代码：testagain.js <br><span class="hljs-keyword">const</span> &#123;ethers&#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;ethers&quot;</span>)<br><br><br><span class="hljs-keyword">let</span> provider = <span class="hljs-keyword">new</span> ethers.JsonRpcProvider(<span class="hljs-string">&#x27;http://localhost:8545&#x27;</span>)<br><br><br><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>);<br><br><span class="hljs-comment">// 读取 JSON 文件</span><br><span class="hljs-keyword">const</span> rawdata = fs.readFileSync(<span class="hljs-string">&#x27;./build/contracts/SimpleStorage.json&#x27;</span>);<br><span class="hljs-keyword">const</span> contractData = <span class="hljs-built_in">JSON</span>.parse(rawdata);<br><br><span class="hljs-comment">// 提取 ABI</span><br><span class="hljs-keyword">const</span> abi = contractData.abi;<br><span class="hljs-comment">// 地址来自上面部署的合约</span><br><span class="hljs-keyword">let</span> contractAddress = <span class="hljs-string">&quot;0xC4bC1f775dB36c07b0bC506cbB83fCe12E182053&quot;</span>;<br><br><span class="hljs-comment">// 使用Provider 连接合约，将只有对合约的可读权限</span><br><span class="hljs-keyword">let</span> contract = <span class="hljs-keyword">new</span> ethers.Contract(contractAddress, abi, provider);<br><br>(<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br><span class="hljs-keyword">let</span> currentValue = <span class="hljs-keyword">await</span> contract.get();<br><br><span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> currentValue)<br><span class="hljs-built_in">console</span>.log(currentValue);<br><br><br><span class="hljs-comment">// 从私钥获取一个签名器 Signer</span><br><span class="hljs-keyword">let</span> privateKey = <span class="hljs-string">&#x27;0x6cbed15c793ce57650b9877cf6fa156fbef513c4e6134f022a85b1ffdd59b2a1&#x27;</span>;<br><span class="hljs-keyword">let</span> wallet = <span class="hljs-keyword">new</span> ethers.Wallet(privateKey, provider);<br><br><span class="hljs-comment">// 使用签名器创建一个新的合约实例，它允许使用可更新状态的方法</span><br><span class="hljs-keyword">let</span> contractWithSigner = contract.connect(wallet);<br><span class="hljs-comment">// ... 或 ...</span><br><span class="hljs-comment">// let contractWithSigner = new Contract(contractAddress, abi, wallet)</span><br><br><span class="hljs-comment">// 设置一个新值，返回交易</span><br><span class="hljs-keyword">let</span> tx = <span class="hljs-keyword">await</span> contractWithSigner.set(<span class="hljs-number">1111</span>);<br><br><span class="hljs-comment">// 查看: https://ropsten.etherscan.io/tx/0xaf0068dcf728afa5accd02172867627da4e6f946dfb8174a7be31f01b11d5364</span><br><span class="hljs-built_in">console</span>.log(tx.hash);<br><span class="hljs-comment">// &quot;0xaf0068dcf728afa5accd02172867627da4e6f946dfb8174a7be31f01b11d5364&quot;</span><br><br><span class="hljs-comment">// 操作还没完成，需要等待挖矿</span><br><span class="hljs-keyword">await</span> tx.wait();<br><br><span class="hljs-comment">// 再次调用合约的 getValue()</span><br><span class="hljs-keyword">let</span> newValue = <span class="hljs-keyword">await</span> contract.get();<br><br><span class="hljs-built_in">console</span>.log(currentValue);<br>&#125;)();<br><br><br><br><br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20230915190419636.png" srcset="/img/loading.gif" lazyload alt="image-20230915190419636"></p>
<p>ethers-contract</p>
<p><a target="_blank" rel="noopener" href="https://docs.rs/ethers-contract/0.2.2/ethers_contract/struct.Contract.html">https://docs.rs/ethers-contract/0.2.2/ethers_contract/struct.Contract.html</a></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs rust">Example<br>Assuming we already have our contract deployed at address, we’ll proceed to interact with its methods and retrieve raw logs it has emitted.<br><br><span class="hljs-keyword">use</span> ethers::&#123;<br>    abi::Abi,<br>    utils::Solc,<br>    types::&#123;Address, H256&#125;,<br>    contract::Contract,<br>    providers::&#123;Provider, Http&#125;,<br>    signers::Wallet,<br>&#125;;<br><span class="hljs-keyword">use</span> std::convert::TryFrom;<br><br><span class="hljs-comment">// this is a fake address used just for this example</span><br><span class="hljs-keyword">let</span> address = <span class="hljs-string">&quot;eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee&quot;</span>.parse::&lt;Address&gt;()?;<br><br><span class="hljs-comment">// (ugly way to write the ABI inline, you can otherwise read it from a file)</span><br><span class="hljs-keyword">let</span> abi: Abi = serde_json::from_str(<span class="hljs-string">r#&quot;[&#123;&quot;inputs&quot;:[&#123;&quot;internalType&quot;:&quot;string&quot;,&quot;name&quot;:&quot;value&quot;,&quot;type&quot;:&quot;string&quot;&#125;],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;constructor&quot;&#125;,&#123;&quot;anonymous&quot;:false,&quot;inputs&quot;:[&#123;&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;author&quot;,&quot;type&quot;:&quot;address&quot;&#125;,&#123;&quot;indexed&quot;:true,&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;oldAuthor&quot;,&quot;type&quot;:&quot;address&quot;&#125;,&#123;&quot;indexed&quot;:false,&quot;internalType&quot;:&quot;string&quot;,&quot;name&quot;:&quot;oldValue&quot;,&quot;type&quot;:&quot;string&quot;&#125;,&#123;&quot;indexed&quot;:false,&quot;internalType&quot;:&quot;string&quot;,&quot;name&quot;:&quot;newValue&quot;,&quot;type&quot;:&quot;string&quot;&#125;],&quot;name&quot;:&quot;ValueChanged&quot;,&quot;type&quot;:&quot;event&quot;&#125;,&#123;&quot;inputs&quot;:[],&quot;name&quot;:&quot;getValue&quot;,&quot;outputs&quot;:[&#123;&quot;internalType&quot;:&quot;string&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;&#125;],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;&#125;,&#123;&quot;inputs&quot;:[],&quot;name&quot;:&quot;lastSender&quot;,&quot;outputs&quot;:[&#123;&quot;internalType&quot;:&quot;address&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;address&quot;&#125;],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;&#125;,&#123;&quot;inputs&quot;:[&#123;&quot;internalType&quot;:&quot;string&quot;,&quot;name&quot;:&quot;value&quot;,&quot;type&quot;:&quot;string&quot;&#125;],&quot;name&quot;:&quot;setValue&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;&#125;]&quot;#</span>)?;<br><br><span class="hljs-comment">// connect to the network</span><br><span class="hljs-keyword">let</span> client = Provider::&lt;Http&gt;::try_from(<span class="hljs-string">&quot;http://localhost:8545&quot;</span>).unwrap();<br><br><span class="hljs-comment">// create the contract object at the address</span><br><span class="hljs-keyword">let</span> contract = Contract::new(address, abi, client);<br><br><span class="hljs-comment">// Calling constant methods is done by calling `call()` on the method builder.</span><br><span class="hljs-comment">// (if the function takes no arguments, then you must use `()` as the argument)</span><br><span class="hljs-keyword">let</span> init_value: <span class="hljs-built_in">String</span> = contract<br>    .method::&lt;_, <span class="hljs-built_in">String</span>&gt;(<span class="hljs-string">&quot;getValue&quot;</span>, ())?<br>    .call()<br>    .<span class="hljs-keyword">await</span>?;<br><br><span class="hljs-comment">// Non-constant methods are executed via the `send()` call on the method builder.</span><br><span class="hljs-keyword">let</span> call = contract<br>    .method::&lt;_, H256&gt;(<span class="hljs-string">&quot;setValue&quot;</span>, <span class="hljs-string">&quot;hi&quot;</span>.to_owned())?;<br><span class="hljs-keyword">let</span> pending_tx = call.send().<span class="hljs-keyword">await</span>?;<br><br><span class="hljs-comment">// `await`ing on the pending transaction resolves to a transaction receipt</span><br><span class="hljs-keyword">let</span> receipt = pending_tx.confirmations(<span class="hljs-number">6</span>).<span class="hljs-keyword">await</span>?;<br></code></pre></td></tr></table></figure>
<h2 id="rust项目"><a href="#rust项目" class="headerlink" title="rust项目"></a>rust项目</h2><p>1.安装rust <a target="_blank" rel="noopener" href="https://rustup.rs/">https://rustup.rs/</a></p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs vim">curl --proto <span class="hljs-string">&#x27;=https&#x27;</span> --tlsv1.<span class="hljs-number">2</span> -sSf http<span class="hljs-variable">s:</span>//<span class="hljs-keyword">sh</span>.rustup.rs | <span class="hljs-keyword">sh</span><br>查看版本:rustc --<span class="hljs-keyword">version</span><br>初始化：cargo <span class="hljs-keyword">new</span> greeting<br>(posenv) yumohan@unislab-PowerEdge-T640:~/lab/greeting$ tree<br>.<br>├── Cargo.toml<br>└── src<br>    └── main.rs<br><br><span class="hljs-number">1</span> directory, <span class="hljs-number">2</span> <span class="hljs-keyword">files</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20230910160309955.png" srcset="/img/loading.gif" lazyload alt="image-20230910160309955"></p>
<p>2.编译项目</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs bash">cargo build<br>(posenv) yumohan@unislab-PowerEdge-T640:~/lab/greeting$ cargo build<br>   Compiling greeting v0.1.0 (/home/yumohan/lab/greeting)<br>    Finished dev [unoptimized + debuginfo] target(s) <span class="hljs-keyword">in</span> 0.25s<br>(posenv) yumohan@unislab-PowerEdge-T640:~/lab/greeting$ tree<br>.<br>├── Cargo.lock<br>├── Cargo.toml<br>├── src<br>│   └── main.rs<br>└── target<br>    ├── CACHEDIR.TAG<br>    └── debug<br>        ├── build<br>        ├── deps<br>        │   ├── greeting-306597fb1dc386c3<br>        │   └── greeting-306597fb1dc386c3.d<br>        ├── examples<br>        ├── greeting<br>        ├── greeting.d<br>        └── incremental<br>            └── greeting-2cxp7rwau06rz<br>                ├── s-gol9waps7s-18m1yne-a56391dvjman4qstop600xauy<br>                │   ├── 10hnn8nme6zzql0t.o<br>                │   ├── 1df718tgtyout27y.o<br>                │   ├── 2ptuowrc0zov12hh.o<br>                │   ├── 3i7h3lai9swm4afu.o<br>                │   ├── 3om4n0vc34r1o3ww.o<br>                │   ├── 43iba3rcptwn7z5c.o<br>                │   ├── dep-graph.bin<br>                │   ├── query-cache.bin<br>                │   └── work-products.bin<br>                └── s-gol9waps7s-18m1yne.lock<br><br>9 directories, 18 files<br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20230910160626788.png" srcset="/img/loading.gif" lazyload alt="image-20230910160626788"></p>
<p>3.运行项目</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">cargo <span class="hljs-built_in">run</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20230910160746443.png" srcset="/img/loading.gif" lazyload alt="image-20230910160746443"></p>
<p><img src="/images/lab_test/image-20230910160827758.png" srcset="/img/loading.gif" lazyload alt="image-20230910160827758"></p>
<h2 id="rust和ganache-cli测试链交互"><a href="#rust和ganache-cli测试链交互" class="headerlink" title="rust和ganache-cli测试链交互"></a>rust和ganache-cli测试链交互</h2><p>1.添加web3依赖项，Cargo.toml</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[dependencies]</span><br><span class="hljs-attr">web3</span> = <span class="hljs-string">&quot;0.19&quot;</span><br><span class="hljs-attr">tokio</span> = &#123; version = <span class="hljs-string">&quot;1&quot;</span>, features = [<span class="hljs-string">&quot;full&quot;</span>] &#125;<br></code></pre></td></tr></table></figure>
<p>2.编写交互代码，main.rs</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs rust"><span class="hljs-keyword">use</span> web3::transports::Http;<br><span class="hljs-keyword">use</span> web3::Web3;<br><br><span class="hljs-meta">#[tokio::main]</span><br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span></span>() &#123;<br>    <span class="hljs-comment">// 创建一个web3实例，连接到本地的ganache-cli测试链</span><br>    <span class="hljs-keyword">let</span> http = Http::new(<span class="hljs-string">&quot;http://localhost:8545&quot;</span>).unwrap();<br><br>    <span class="hljs-comment">// 创建web3实例</span><br>    <span class="hljs-keyword">let</span> web3 = Web3::new(http);<br><br>    <span class="hljs-comment">// 调用web3.eth().accounts()方法，获取所有账户地址</span><br>    <span class="hljs-keyword">let</span> accounts = web3.eth().accounts().<span class="hljs-keyword">await</span>.unwrap();<br><br>    <span class="hljs-comment">// 打印所有账户地址</span><br>    <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;Accounts: &#123;:?&#125;&quot;</span>, accounts);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>3.运行项目</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">cargo <span class="hljs-built_in">run</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20230910211339344.png" srcset="/img/loading.gif" lazyload alt="image-20230910211339344"></p>
<p>检验正确性，初始的虚拟账户为：</p>
<p><img src="/images/lab_test/image-20230910211714219.png" srcset="/img/loading.gif" lazyload alt="image-20230910211714219"></p>
<h2 id="安装Solidity编译器"><a href="#安装Solidity编译器" class="headerlink" title="安装Solidity编译器"></a>安装Solidity编译器</h2><p>资料： <a target="_blank" rel="noopener" href="https://solidity-cn.readthedocs.io/zh/develop/installing-solidity.html">https://solidity-cn.readthedocs.io/zh/develop/installing-solidity.html</a></p>
<h5 id="1-安装solidity版本管理器"><a href="#1-安装solidity版本管理器" class="headerlink" title="1.安装solidity版本管理器"></a>1.安装solidity版本管理器</h5><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">pip</span> install solc-<span class="hljs-literal">select</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20230913143429967.png" srcset="/img/loading.gif" lazyload alt="image-20230913143429967"></p>
<h5 id="2-选择版本进行安装-启用-验证"><a href="#2-选择版本进行安装-启用-验证" class="headerlink" title="2.选择版本进行安装/启用/验证"></a>2.选择版本进行安装/启用/验证</h5><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">solc</span>-select install <span class="hljs-number">0</span>.<span class="hljs-number">8</span>.<span class="hljs-number">17</span><br><span class="hljs-attribute">solc</span>-select install <span class="hljs-number">0</span>.<span class="hljs-number">8</span>.<span class="hljs-number">17</span> &amp;&amp; solc-select use <span class="hljs-number">0</span>.<span class="hljs-number">8</span>.<span class="hljs-number">17</span><br><span class="hljs-attribute">solc</span> --version<br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20230913143547150.png" srcset="/img/loading.gif" lazyload alt="image-20230913143547150"></p>
<p><img src="/images/lab_test/image-20230913143355543.png" srcset="/img/loading.gif" lazyload alt="image-20230913143355543"></p>
<p>3.与合约进行交互</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><code class="hljs rust">用ethers.js与合约交互 <br><br>main.rs<br><br><span class="hljs-keyword">use</span> std::env;<br><br><span class="hljs-keyword">use</span> std::time::&#123;SystemTime&#125;;<br><br><span class="hljs-keyword">use</span> std::time::Duration;<br><br><span class="hljs-keyword">use</span> std::thread::sleep;<br><br><br><br><span class="hljs-keyword">use</span> ethers_signers::&#123;LocalWallet&#125;;<br><br><span class="hljs-keyword">use</span> ethers_core::types::transaction::eip2930::&#123;AccessList,AccessListItem&#125;;<br><br><span class="hljs-keyword">use</span> ethers_providers::&#123;Provider&#125;;<br><br><span class="hljs-keyword">use</span> ethers_core::types::&#123;Address&#125;;<br><br><span class="hljs-keyword">use</span> ethers_middleware::SignerMiddleware;<br><br><span class="hljs-keyword">use</span> std::sync::Arc;<br><br><br><br><span class="hljs-keyword">use</span> ethers::&#123;<br><br>  prelude::*,<br><br>&#125;;<br><br><br><br><span class="hljs-keyword">use</span> eyre::<span class="hljs-built_in">Result</span>;<br><br><span class="hljs-keyword">const</span> RPC_URL: &amp;<span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;http://localhost:8545&quot;</span>;<br><br><br><br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">print_balances</span></span>(provider: &amp;Provider&lt;Http&gt;, address_from: Address, address_to: Address) -&gt; <span class="hljs-built_in">Result</span>&lt;(), <span class="hljs-built_in">Box</span>&lt;<span class="hljs-keyword">dyn</span> std::error::Error&gt;&gt; &#123;<br><br>  <span class="hljs-comment">// 2. Use the get_balance function</span><br><br>  <span class="hljs-keyword">let</span> balance_from = provider.get_balance(address_from, <span class="hljs-literal">None</span>).<span class="hljs-keyword">await</span>?;<br><br>  <span class="hljs-keyword">let</span> balance_to = provider.get_balance(address_to, <span class="hljs-literal">None</span>).<span class="hljs-keyword">await</span>?;<br><br><br><br>  <span class="hljs-comment">// 3. Print the resultant balance</span><br><br>  <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;&#123;&#125; has &#123;&#125;&quot;</span>, address_from, balance_from);<br><br>  <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;&#123;&#125; has &#123;&#125;&quot;</span>, address_to, balance_to);<br><br><br><br>  <span class="hljs-literal">Ok</span>(())<br><br>&#125;<br><br><br><br><br><br><span class="hljs-comment">//解析abi</span><br><br>  abigen!(SimpleStorage, <span class="hljs-string">&quot;./SimpleStorageABI.json&quot;</span>);<br><br><br><br>\<span class="hljs-meta">#[tokio::main]</span><br><br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span></span>() -&gt; <span class="hljs-built_in">Result</span>&lt;(), <span class="hljs-built_in">Box</span>&lt;<span class="hljs-keyword">dyn</span> std::error::Error&gt;&gt; &#123;<br><br><br><br>  <span class="hljs-comment">//创建provider连接区块链,用try_from</span><br><br>  <span class="hljs-keyword">let</span> provider = Provider::&lt;Http&gt;::try_from(RPC_URL)?;<br><br>  <span class="hljs-comment">//查询区块数量</span><br><br>  <span class="hljs-keyword">let</span> block_number: U64 = provider.get_block_number().<span class="hljs-keyword">await</span>?;<br><br>  <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;&#123;block_number&#125;&quot;</span>);<br><br>  <br><br><br><br>  <span class="hljs-comment">//用私钥创建钱包</span><br><br>  <span class="hljs-keyword">let</span> wallet: LocalWallet = <span class="hljs-string">&quot;4f3edf983ac636a65a842ce7c78d9aa706d3b113bce9c46f30d7d21715b23b1d&quot;</span><br><br>​    .parse::&lt;LocalWallet&gt;()?<br><br>​    .with_chain_id(Chain::MoonbeamDev);<br><br><br><br>  <span class="hljs-comment">//将provider和钱包一起包装成一个client</span><br><br>  <span class="hljs-keyword">let</span> client = SignerMiddleware::new(provider.clone(), wallet.clone());<br><br><br><br>  <span class="hljs-comment">//确定转账的对方</span><br><br>  <span class="hljs-keyword">let</span> address_from = <span class="hljs-string">&quot;0x90F8bf6A479f320ead074411a4B0e7944Ea8c9C1&quot;</span>.parse::&lt;Address&gt;()?;<br><br>  <span class="hljs-keyword">let</span> address_to = <span class="hljs-string">&quot;0xFFcf8FDEE72ac11b5c542428B35EEF5769C409f0&quot;</span>.parse::&lt;Address&gt;()?;<br><br><br><br>  <span class="hljs-comment">//调用函数查询余额</span><br><br>  print_balances(&amp;provider,address_from,address_to).<span class="hljs-keyword">await</span>?;<br><br><br><br>  <span class="hljs-comment">//调用读取合约数据函数</span><br><br>  <span class="hljs-keyword">let</span> contract_addr = <span class="hljs-string">&quot;0xC4bC1f775dB36c07b0bC506cbB83fCe12E182053&quot;</span>.parse::&lt;Address&gt;()?;<br><br>  <span class="hljs-keyword">let</span> client_arc = Arc::new(client.clone());<br><br>  <span class="hljs-keyword">let</span> simple_storage_instance = SimpleStorage::new(contract_addr, Arc::clone(&amp;client_arc)); <br><br>  <span class="hljs-comment">//Contracts Rust Ethers credit: https://docs.rs/ethers-contract/0.2.2/ethers_contract/struct.Contract.html</span><br><br><br><br>  <span class="hljs-keyword">let</span> stored_data_value = simple_storage_instance.get().call().<span class="hljs-keyword">await</span>?;<br><br>  <br><br>  <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;storedDataValue before transaction: &#123;0&#125;&quot;</span>, stored_data_value);<br><br><br><br>  <span class="hljs-comment">// send_set_tx(simple_storage_instance.clone()).await.expect(&quot;Transaction function error&quot;); //Clone the value to avoid Rust borrow checker error.</span><br><br>  <span class="hljs-literal">Ok</span>(())<br><br><br><br>&#125;<br><br><br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20230915190627452.png" srcset="/img/loading.gif" lazyload alt="image-20230915190627452"></p>
<h2 id="安装Docker-部署sgx环境"><a href="#安装Docker-部署sgx环境" class="headerlink" title="安装Docker + 部署sgx环境"></a>安装Docker + 部署sgx环境</h2><h5 id="1-安装Docker"><a href="#1-安装Docker" class="headerlink" title="1.安装Docker"></a>1.安装Docker</h5><p>参考：<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/ubuntu/">https://docs.docker.com/engine/install/ubuntu/</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin<br>(posenv) yumohan@unislab-PowerEdge-T640:~/lab$ sudo docker run hello-world<br><br>Hello from Docker!<br>This message shows that your installation appears to be working correctly.<br><br>To generate this message, Docker took the following steps:<br><br>  1. The Docker client contacted the Docker daemon.<br>  2. The Docker daemon pulled the <span class="hljs-string">&quot;hello-world&quot;</span> image from the Docker Hub.<br>     (amd64)<br>  3. The Docker daemon created a new container from that image <span class="hljs-built_in">which</span> runs the<br>     executable that produces the output you are currently reading.<br>  4. The Docker daemon streamed that output to the Docker client, <span class="hljs-built_in">which</span> sent it<br>     to your terminal.<br><br>To try something more ambitious, you can run an Ubuntu container with:<br> $ docker run -it ubuntu bash<br><br>Share images, automate workflows, and more with a free Docker ID:<br> https://hub.docker.com/<br><br>For more examples and ideas, visit:<br> https://docs.docker.com/get-started/<br></code></pre></td></tr></table></figure>
<h5 id="2-安装-docker-compose"><a href="#2-安装-docker-compose" class="headerlink" title="2.安装 docker-compose"></a>2.安装 docker-compose</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">sudo curl -L <span class="hljs-string">&quot;https://github.com/docker/compose/releases/download/1.27.4/docker-compose-$(uname -s)-$(uname -m)&quot;</span> -o <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>docker-compose<br></code></pre></td></tr></table></figure>
<h5 id="3-拉取teaclave仓库和docker镜像"><a href="#3-拉取teaclave仓库和docker镜像" class="headerlink" title="3.拉取teaclave仓库和docker镜像"></a>3.拉取teaclave仓库和docker镜像</h5><p><strong>参考资料</strong></p>
<ol>
<li><a target="_blank" rel="noopener" href="https://teaclave.apache.org/blog/2021-08-25-developing-sgx-application-with-teaclave-sgx-sdk/">使用 TEACLAVE SGX SDK 开发 SGX 应用</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/dingelish/SGXfail/blob/master/01.md">剖析hello-rust</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/apache/incubator-teaclave-sgx-sdk">incubator-teaclave-sgx-sdk</a></li>
<li><a target="_blank" rel="noopener" href="https://teaclave.apache.org/docs/my-first-function/#simulation-mode"> Simulation Mode</a></li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ git <span class="hljs-built_in">clone</span> https://github.com/apache/incubator-teaclave-sgx-sdk.git<br>$ docker pull teaclave/teaclave-build-ubuntu-1804-sgx-2.9.1:latest<br><br>将sdk仓库挂载到容器中的root/sgx/目录下，并启动拉取到的镜像<br>$ docker run -v /path/to/rust-sgx（你下载的sgx仓库的绝对路径）:/root/sgx -ti teaclave/teaclave-build-ubuntu-1804-sgx-2.9.1:latest<br><br>docker run --name pet --net host -v /home/yumohan/lab/incubator-teaclave-sgx-sdk:/root/sgx -p 8080:50051 -ti teaclave/teaclave-build-ubuntu-1804-sgx-2.9.1:latest<br><br><br><br><br>docker run -dit --name rust-grpc-server -v $(<span class="hljs-built_in">pwd</span>):/usr/src/app -v /usr/src/app/target -p 8080:50051 rust-grpc-server<br>docker run --net host --name rust-grpc-server -v $(<span class="hljs-built_in">pwd</span>):/usr/src/app -v /usr/src/app/target -it  teaclave/teaclave-build-ubuntu-1804-sgx-2.9.1:latest<br><br>在 Linux 系统上，你可以使用 netstat 或 ss 命令来检查某个特定端口是否被监听。<br><br>使用 netstat：netstat -tuln | grep 50051<br>使用 ss：ss -tuln | grep 50051<br><br>Once inside the container, when running any of the samplecode you may either:<br>Modify the Makefile and <span class="hljs-built_in">set</span> SGX_MODE to SW<br>Run <span class="hljs-built_in">export</span> SGX_MODE=SW<br>Run make with the build flag SGX_MODE=SW<br>We may now run our helloworld example:<br><br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20230918094108844.png" srcset="/img/loading.gif" lazyload alt="image-20230918094108844"></p>
<p><img src="/images/lab_test/image-20230918094511111.png" srcset="/img/loading.gif" lazyload alt="image-20230918094511111"></p>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vala">在容器用模拟模式Simulation Mode运行示例代码<br><span class="hljs-meta"># cd sgx/samplecode/helloworld</span><br><span class="hljs-meta"># make SGX_MODE=SW</span><br><span class="hljs-meta"># cd bin</span><br><span class="hljs-meta"># ./app</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20230918100015122.png" srcset="/img/loading.gif" lazyload alt="image-20230918100015122"></p>
<p><img src="/images/lab_test/image-20230918100507264.png" srcset="/img/loading.gif" lazyload alt="image-20230918100507264"></p>
<h5 id="4-一些命令"><a href="#4-一些命令" class="headerlink" title="4.一些命令"></a>4.一些命令</h5><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">查看运行的容器：docker ps<br>查看所有容器：docker ps -<span class="hljs-keyword">a</span><br>停止容器：docker <span class="hljs-built_in">stop</span> my_container/ID<br>重新启动容器：docker <span class="hljs-built_in">start</span> my_container<br>进入容器：docker exec -<span class="hljs-keyword">it</span> my_container /bin/bash<br>查看挂载信息：docker inspect [container_id] | jq <span class="hljs-string">&#x27;.[].Mounts&#x27;</span><br>删除容器：<br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20230918104923278.png" srcset="/img/loading.gif" lazyload alt="image-20230918104923278"></p>
<h5 id="5-ECALL-OCALL"><a href="#5-ECALL-OCALL" class="headerlink" title="5.ECALL/OCALL"></a>5.ECALL/OCALL</h5><blockquote>
<p>在 Intel SGX（Software Guard Extensions）中，ECALL（Enclave Call）和 OCALL（Outcall）是用于在应用程序和 SGX 安全执行环境（Enclave）之间进行通信的机制。</p>
<ol>
<li><p><strong>ECALL（Enclave Call）</strong>：</p>
<ul>
<li><strong>ECALL</strong> 是从应用程序代码调用 SGX 安全执行环境（Enclave）中的函数或方法的方式。这些函数通常是由 Enclave 开发者编写的，用于执行安全计算任务。</li>
<li>ECALL 通常用于将控制从应用程序传递到 Enclave 内部，以便执行受保护的操作。这些操作可能包括对敏感数据的访问、密钥管理、加密和解密等。</li>
<li>ECALL 通过调用 Enclave 内部的函数来实现，这些函数必须被声明为 ECALL 函数，并且可以接收参数和返回结果。</li>
</ul>
</li>
<li><p><strong>OCALL（Outcall）</strong>：</p>
<ul>
<li><strong>OCALL</strong> 是从 SGX Enclave 中调用应用程序代码中的函数或方法的方式。这是一种从安全执行环境向非安全执行环境传递控制的机制。</li>
<li>OCALL 允许 Enclave 内部的代码调用应用程序中的函数，以便执行 Enclave 无法执行的非安全操作。这些操作可能包括文件系统访问、网络通信、用户界面交互等。</li>
<li>OCALL 通过在 Enclave 代码中使用特殊的 OCALL 指令来触发，并且必须与应用程序代码中的 OCALL 函数相匹配，以便正确执行操作。</li>
</ul>
</li>
</ol>
<p>总之，ECALL 和 OCALL 是 Intel SGX 中用于实现安全通信和控制流的关键机制。ECALL 用于从应用程序传递控制到 Enclave 内部，而 OCALL 用于从 Enclave 内部传递控制到应用程序代码，以便执行安全操作和与非安全环境进行交互。这些机制有助于确保 Enclave 内的安全性，同时允许执行需要在非安全环境中完成的任务。</p>
</blockquote>
<ul>
<li><strong><code>Enclave.edl</code></strong></li>
<li>该文件规定了 Enclave 边界 <code>ECALL/OCALL</code> 的定义。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c">enclave &#123;<br>    from <span class="hljs-string">&quot;sgx_tstd.edl&quot;</span> <span class="hljs-keyword">import</span> *;<br>    from <span class="hljs-string">&quot;sgx_stdio.edl&quot;</span> <span class="hljs-keyword">import</span> *;<br>    from <span class="hljs-string">&quot;sgx_backtrace.edl&quot;</span> <span class="hljs-keyword">import</span> *;<br>    from <span class="hljs-string">&quot;sgx_tstdc.edl&quot;</span> <span class="hljs-keyword">import</span> *;<br><br>    trusted &#123;<br>        <span class="hljs-comment">/* define ECALLs here. */</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">sgx_status_t</span> <span class="hljs-title">say_something</span><span class="hljs-params">([in, size=len] <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span>* some_string, <span class="hljs-keyword">size_t</span> len)</span></span>;<br>    &#125;;<br><br>    untrusted &#123;<br><br>    &#125;;<br>&#125;;<br></code></pre></td></tr></table></figure>
<p><code>trusted &#123;...&#125;</code> 中声明 <code>ECALL</code> 函数， <code>untrusted &#123;...&#125;</code> 中声明 <code>OCALL</code> 函数。本例中声明了一个 <code>ECALL</code> 函数 <code>say_something</code>，该函数的具体实现在 <code>src/lib.rs</code> 中，它的参数包括 <code>uint8_t *</code> 类型的指针和长度参数 <code>len</code>。</p>
<ul>
<li><strong><code>src/lib.rs</code></strong> </li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs rust"><span class="hljs-meta">#[no_mangle]</span><br><span class="hljs-keyword">pub</span> <span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">say_something</span></span>(some_string: *<span class="hljs-keyword">const</span> <span class="hljs-built_in">u8</span>, some_len: <span class="hljs-built_in">usize</span>) -&gt; sgx_status_t &#123;<br><br>    <span class="hljs-keyword">let</span> str_slice = <span class="hljs-keyword">unsafe</span> &#123; slice::from_raw_parts(some_string, some_len) &#125;;<br>    <span class="hljs-keyword">let</span> _ = io::stdout().write(str_slice);<br><br>    <span class="hljs-comment">// A sample &amp;&#x27;static string</span><br>    <span class="hljs-keyword">let</span> rust_raw_string = <span class="hljs-string">&quot;This is a &quot;</span>;<br>    <span class="hljs-comment">// An array</span><br>    <span class="hljs-keyword">let</span> word:[<span class="hljs-built_in">u8</span>;<span class="hljs-number">4</span>] = [<span class="hljs-number">82</span>, <span class="hljs-number">117</span>, <span class="hljs-number">115</span>, <span class="hljs-number">116</span>];<br>    <span class="hljs-comment">// An vector</span><br>    <span class="hljs-keyword">let</span> word_vec:<span class="hljs-built_in">Vec</span>&lt;<span class="hljs-built_in">u8</span>&gt; = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">32</span>, <span class="hljs-number">115</span>, <span class="hljs-number">116</span>, <span class="hljs-number">114</span>, <span class="hljs-number">105</span>, <span class="hljs-number">110</span>, <span class="hljs-number">103</span>, <span class="hljs-number">33</span>];<br><br>    <span class="hljs-comment">// Construct a string from &amp;&#x27;static string</span><br>    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> hello_string = <span class="hljs-built_in">String</span>::from(rust_raw_string);<br><br>    <span class="hljs-comment">// Iterate on word array</span><br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> word.iter() &#123;<br>        hello_string.push(*c <span class="hljs-keyword">as</span> <span class="hljs-built_in">char</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// Rust style convertion</span><br>    hello_string += <span class="hljs-built_in">String</span>::from_utf8(word_vec).expect(<span class="hljs-string">&quot;Invalid UTF-8&quot;</span>)<br>                                               .as_str();<br><br>    <span class="hljs-comment">// Ocall to normal world for output</span><br>    <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;&#123;&#125;&quot;</span>, &amp;hello_string);<br><br>    sgx_status_t::SGX_SUCCESS<br>&#125;<br><br></code></pre></td></tr></table></figure>
<ul>
<li><strong><code>app/app.c</code></strong></li>
</ul>
<p>在 <code>app/app.c</code> 的 <code>main</code> 函数中有一个完整的调用 <code>ECALL</code> 的例子。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs text">sgx_ret = say_something(global_eid,<br>                        &amp;enclave_ret,<br>                        (const uint8_t *) str,<br>                        len);<br></code></pre></td></tr></table></figure>
<p>这里的 <code>say_something</code> 似乎和 <code>Enclave.edl</code> 中的声明不太一样，ECALL传递参数时多了两个隐参数：<code>enclave_eid</code> 和 <code>say_something</code> 的返回值 <code>&amp;enclave_ret</code>。而 <code>sgx_ret</code> 表示的是 ECALL 执行是否成功，是 SGX 的返回值。</p>
<h5 id="6-edger8r"><a href="#6-edger8r" class="headerlink" title="6.edger8r"></a>6.edger8r</h5><blockquote>
<p>edger8r 是 Intel SGX（Software Guard Extensions）平台提供的一个工具，用于生成与 SGX Enclave 相关的代码。具体来说，它可以根据输入的 EDL（Enclave Definition Language）文件生成用于 Enclave 与非安全应用程序通信的 C 代码。</p>
<p>EDL 是一种特殊的语言，用于定义 SGX Enclave 内的函数和数据结构，以及与非安全应用程序之间的通信接口。edger8r 通过读取 EDL 文件并解析其中的接口定义，然后生成以下文件：</p>
<ol>
<li><strong>Enclave_u.h</strong>：这个文件包含了 Enclave 与非安全应用程序之间通信的函数原型。通常，这些函数原型是 OCALL 函数，允许 Enclave 调用应用程序中的函数。</li>
<li><strong>Enclave_u.c</strong>：这个文件包含了与 Enclave_u.h 中的函数原型相关的函数实现。它定义了如何将 Enclave 内的函数调用传递给应用程序，并处理 Enclave 和非安全环境之间的数据传输。</li>
</ol>
<p>通过生成这些文件，edger8r 可以帮助开发者创建 Enclave 与应用程序之间的接口，并简化 Enclave 与非安全应用程序之间的通信。这些文件是 Enclave 开发的关键组成部分，确保了安全的函数调用和数据传输。</p>
<p>helloworld 编译的基本流程类似于 Intel SGX:</p>
<ul>
<li><code>edger8r</code> 将输入的 <code>EDL</code> 在 <code>app/</code> 目录下生成不可信代码 <code>Enclave_u.h</code> 和 <code>Enclave_u.c</code>；</li>
<li>编译不可信部分生成 <code>bin/app</code>；</li>
<li><code>edger8r</code> 在 <code>enclave/</code> 目录下生成可信代码 <code>Enclave_t.h</code> 和 <code>Enclave_t.c</code>；</li>
<li>编译并签名生成可信动态链接库 <code>enclave.signed.so</code></li>
</ul>
</blockquote>
<h5 id="7-开发自己的程序"><a href="#7-开发自己的程序" class="headerlink" title="7.开发自己的程序"></a>7.开发自己的程序</h5><blockquote>
<p><a target="_blank" rel="noopener" href="https://teaclave.apache.org/blog/2021-08-25-developing-sgx-application-with-teaclave-sgx-sdk/">基于 Teaclave SGX SDK 的 helloworld 实现了自己的求交集函数</a></p>
</blockquote>
<p><img src="/images/lab_test/image-20230918151851875.png" srcset="/img/loading.gif" lazyload alt="image-20230918151851875"></p>
<h5 id="8-查找teaclave提供的库crate"><a href="#8-查找teaclave提供的库crate" class="headerlink" title="8.查找teaclave提供的库crate"></a>8.查找teaclave提供的库crate</h5><blockquote>
<p><a target="_blank" rel="noopener" href="https://teaclave.apache.org/api-docs/crates-enclave/">https://teaclave.apache.org/api-docs/crates-enclave/</a></p>
</blockquote>
<p>Teaclave SGX SDK 重写了很多 SGX 的库，当我们需要用某个库时，可以先在仓库中查看是否有相应的 <code>crate</code> 实现以及对应的 <a target="_blank" rel="noopener" href="https://teaclave.apache.org/api-docs/crates-enclave/">doc</a>。比如当我们希望生成一个随机数时，在 <code>C++</code> 或者 <code>Rust</code> 环境下，会想到使用 <code>rand</code> 库。自然而然地，Teaclave SGX SDK 也用 Rust 重写了 <a target="_blank" rel="noopener" href="https://github.com/apache/incubator-teaclave-sgx-sdk/tree/master/sgx_rand"><code>sgx_rand</code></a> 库。</p>
<p>首先在 <code>enclave/Cargo.toml</code> 中的 <code>[target.&#39;cfg(not(target_env = &quot;sgx&quot;))&#39;.dependencies]</code> 部分添加 <code>sgx_rand</code> 库的地址。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">[target.&#x27;cfg(not(target_env = &quot;sgx&quot;))&#x27;.dependencies]<br>sgx_rand = &#123;git = &quot;https://github.com/apache/teaclave-sgx-sdk.git&quot; &#125;<br></code></pre></td></tr></table></figure>
<p>现在万事俱备，只欠调用。回到 <code>lib.rs</code> 文件中，链接到 <code>sgx_rand</code> <code>crate</code>，导入其中的所有项，声明需要使用的模块。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs text">extern crate sgx_rand;<br>use sgx_rand::Rng;<br>use sgx_rand::os::SgxRng;<br></code></pre></td></tr></table></figure>
<p>调用 <code>gen_range</code> 函数生成 0-10 之间的随机数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">let random = rng.gen_range(0, 10);<br></code></pre></td></tr></table></figure>
<p>这样就可以在 Teaclave SGX SDK 中的 enclave 中通过调用官方 <code>crate</code> 随机生成一个随机数。</p>
<h2 id="PET实验"><a href="#PET实验" class="headerlink" title="PET实验"></a>PET实验</h2><p>技术框架：</p>
<p>·     ganache-cli 运行以太坊测试链</p>
<p>·     truffle框架，编写智能合约，部署智能合约（Solidity）到测试链，编写性能测试代码（Javascript代码）</p>
<p>·     rust写链下节点和enclave之间的交互，rust写与测试链的交互</p>
<p>·     docker 中运行sgx模拟环境（rust与enclave交互的部分放在docker中运行）</p>
<p>实验思路：</p>
<p>\1.  一个.sol文件——编写链上coordinator 合约逻辑（确定函数功能）</p>
<p>•    接收用户调用，保存用户请求</p>
<p>•    接收合约注册回调函数（回调具体设计参考论文Tesseract）</p>
<p>•    接收飞地返回的结果</p>
<p>•    处理链下跨合约请求</p>
<p>\2.  .rs文件，实现</p>
<p>•    provider从区块链读取数据 </p>
<p>•    provider与飞地交互接口函数</p>
<p>•    飞地部署合约</p>
<p>•    飞地初始化</p>
<p>•    飞地执行合约</p>
<p>•    飞地返回状态</p>
<p>•    飞地中初始化时的密钥生成算法</p>
<p>•    飞地中读集生成</p>
<p>链下observer正确性保证的验证：设置n次提交，m次恶意提交，对比有observer和无observer时合约的错误检测率</p>
<p>计算节点：</p>
<p>1.写一个监听，写一个将计算任务启动docker在sgx运行，接收sgx返回的结果并返回链上</p>
<p>链上逻辑功能：</p>
<p>1.记录调用 + 管理调用列表 + 收集结果</p>
<p>以上从一个例子开始：</p>
<p>链下合约功能为：实现a + b</p>
<p>链上合约</p>
<p>1.拉取 teaclave-client仓库并挂载到镜像</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/apache/i</span>ncubator-teaclave.git<br>cd incubator-teaclave<br>(下面的命令分开执行，先启动起容器，再在teaclave目录下设置)<br>若报错目录权限，执行：git config --global --add safe.directory /teaclave<br>docker run --name pet_grpc2 -v $(pwd):<span class="hljs-regexp">/teaclave -w /</span>teaclave \<br>  -it teaclave/teaclave-build-ubuntu-<span class="hljs-number">1804</span>-sgx-<span class="hljs-number">2.9</span>.<span class="hljs-number">1</span>:latest \<br>   bash -c <span class="hljs-string">&quot;. /root/.cargo/env &amp;&amp; \</span><br><span class="hljs-string">     . /opt/sgxsdk/environment &amp;&amp; \</span><br><span class="hljs-string">     mkdir -p build &amp;&amp; cd build &amp;&amp; \</span><br><span class="hljs-string">     cmake -DTEST_MODE=ON -DSGX_SIM_MODE=ON .. &amp;&amp; \</span><br><span class="hljs-string">     make -j&quot;</span><br>     <br>     teaclave/teaclave-build-ubuntu-<span class="hljs-number">1804</span>-sgx-<span class="hljs-number">2.9</span>.<span class="hljs-number">1</span>:latest<br>     docker run --name petrpc --net host -v $(pwd):<span class="hljs-regexp">/teaclave -net host -ti teaclave/</span>teaclave-build-ubuntu-<span class="hljs-number">1804</span>-sgx-<span class="hljs-number">2.17</span>.<span class="hljs-number">1</span>:<span class="hljs-number">0.2</span>.<span class="hljs-number">0</span><br>     docker run --name pet -v <span class="hljs-regexp">/home/yum</span>ohan<span class="hljs-regexp">/lab/i</span>ncubator-teaclave-sgx-sdk:<span class="hljs-regexp">/root/</span>sgx -ti baiduxlab/sgx-rust<br></code></pre></td></tr></table></figure>
<p><img src="../images/lab_test/image-20231024142330189.png" srcset="/img/loading.gif" lazyload alt="image-20231024142330189"></p>
<p><img src="/images/lab_test/image-20231114110008995.png" srcset="/img/loading.gif" lazyload alt="image-20231114110008995"></p>
<p>2.设置环境变量</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-builtin-name">export</span> <span class="hljs-attribute">AS_SPID</span>=<span class="hljs-string">&quot;00000000000000000000000000000000&quot;</span><br><span class="hljs-builtin-name">export</span> <span class="hljs-attribute">AS_KEY</span>=<span class="hljs-string">&quot;00000000000000000000000000000000&quot;</span><br><span class="hljs-builtin-name">export</span> <span class="hljs-attribute">AS_ALGO</span>=<span class="hljs-string">&quot;sgx_epid&quot;</span><br><span class="hljs-builtin-name">export</span> <span class="hljs-attribute">AS_URL</span>=<span class="hljs-string">&quot;https://api.trustedservices.intel.com:443&quot;</span><br></code></pre></td></tr></table></figure>
<h5 id="部署-coordinator合约"><a href="#部署-coordinator合约" class="headerlink" title="部署 coordinator合约"></a>部署 coordinator合约</h5><p><img src="/images/lab_test/image-20231108102854718.png" srcset="/img/loading.gif" lazyload alt="image-20231108102854718"></p>
<h5 id="注册TEE-amp-查询"><a href="#注册TEE-amp-查询" class="headerlink" title="注册TEE&amp;查询"></a>注册TEE&amp;查询</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><code class="hljs rust"><span class="hljs-keyword">use</span> std::env;<br><span class="hljs-keyword">use</span> std::time::&#123;SystemTime&#125;;<br><span class="hljs-keyword">use</span> std::time::Duration;<br><span class="hljs-keyword">use</span> std::thread::sleep;<br><span class="hljs-keyword">use</span> ethers_core::utils::hex::FromHex;<br><span class="hljs-keyword">use</span> std::<span class="hljs-built_in">str</span>::FromStr;<br><span class="hljs-keyword">use</span> ethers_signers::&#123;LocalWallet&#125;;<br><span class="hljs-keyword">use</span> ethers_core::types::transaction::eip2930::&#123;AccessList,AccessListItem&#125;;<br><span class="hljs-keyword">use</span> ethers_providers::&#123;Provider&#125;;<br><span class="hljs-keyword">use</span> ethers_core::types::&#123;Address&#125;;<br><span class="hljs-keyword">use</span> ethers_middleware::SignerMiddleware;<br><span class="hljs-keyword">use</span> std::sync::Arc;<br><br><span class="hljs-keyword">use</span> ethers::&#123;<br>    prelude::*,<br>&#125;;<br><br><span class="hljs-keyword">mod</span> lib;<br><br><span class="hljs-keyword">use</span> lib::&#123;register_enclave,get_provide_byAddr&#125;;<br><span class="hljs-keyword">use</span> eyre::<span class="hljs-built_in">Result</span>;<br><span class="hljs-keyword">const</span> RPC_URL: &amp;<span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;http://localhost:8545&quot;</span>;<br><br><span class="hljs-comment">//解析abi</span><br>abigen!(SimpleStorage, <span class="hljs-string">&quot;./SimpleStorageABI.json&quot;</span>);<br><span class="hljs-comment">//解析abi</span><br>abigen!(Coordinator, <span class="hljs-string">&quot;./coordinatorABI.json&quot;</span>);<br><br><span class="hljs-meta">#[tokio::main]</span><br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span></span>() -&gt; <span class="hljs-built_in">Result</span>&lt;(), <span class="hljs-built_in">Box</span>&lt;<span class="hljs-keyword">dyn</span> std::error::Error&gt;&gt; &#123;<br><br>    <span class="hljs-comment">//创建provider连接区块链,用try_from</span><br>    <span class="hljs-keyword">let</span> provider = Provider::&lt;Http&gt;::try_from(RPC_URL)?;<br>    <span class="hljs-comment">//查询区块数量</span><br>    <span class="hljs-keyword">let</span> block_number: U64 = provider.get_block_number().<span class="hljs-keyword">await</span>?;<br>   <br>    <span class="hljs-comment">//确定转账的对方</span><br>    <span class="hljs-keyword">let</span> address_from = <span class="hljs-string">&quot;0xcF01f9F4131aD4572BC99285170fF7bf44798382&quot;</span>.parse::&lt;Address&gt;()?;<br>    <span class="hljs-keyword">let</span> address_to = <span class="hljs-string">&quot;0x4ed26b20D7c781d1AbF744A17a716C11d075e333&quot;</span>.parse::&lt;Address&gt;()?;<br><br>    <span class="hljs-comment">//调用函数查询余额</span><br>    print_balances(&amp;provider,address_from,address_to).<span class="hljs-keyword">await</span>?;<br><br>    <br>    <span class="hljs-comment">/***************************************</span><br><span class="hljs-comment">                    合约测试</span><br><span class="hljs-comment">    ****************************************/</span><br><br>    <span class="hljs-comment">//链上coordinator合约地址 为0x53241C9599EDefbad29dc1Dd6d9230AEfD03902A</span><br>    <span class="hljs-keyword">let</span> contract_addr = <span class="hljs-string">&quot;0x53241C9599EDefbad29dc1Dd6d9230AEfD03902A&quot;</span>.parse::&lt;Address&gt;()?;<br>   <span class="hljs-comment">// let client_arc = Arc::new(client.clone());</span><br><br><span class="hljs-comment">// TEE 1注册</span><br>    <span class="hljs-comment">//用私钥创建钱包</span><br>    <span class="hljs-keyword">let</span> wallet1: LocalWallet = <span class="hljs-string">&quot;db2fa8512a2ffbcd3f00bdeba53f2760321e98a198b234a9bd6d8a22dfa5a9de&quot;</span><br>        .parse::&lt;LocalWallet&gt;()?<br>        .with_chain_id(Chain::MoonbeamDev);<br><br>    <span class="hljs-comment">//将provider和钱包一起包装成一个client</span><br>    <span class="hljs-keyword">let</span> client1 = SignerMiddleware::new(provider.clone(), wallet1.clone());<br>    <br><span class="hljs-comment">//     //测试注册功能</span><br><span class="hljs-comment">//     // 字节数组（使用 Vec&lt;u8&gt; 表示）</span><br><span class="hljs-comment">//     let pk_tee = Vec::&lt;u8&gt;::from_hex(&quot;00&quot;).expect(&quot;Failed to parse hex&quot;);</span><br><br><span class="hljs-comment">//     // 字节数组（使用 Bytes 表示）</span><br><span class="hljs-comment">//     let attestation_signature = (&quot;6B273B5e911742Fa71259c6dd7B43411503A7258&quot;).parse::&lt;Bytes&gt;()?;</span><br><br><span class="hljs-comment">//     //1.注册飞地- 通过</span><br><span class="hljs-comment">//     register_enclave(&amp;client1,&amp;contract_addr,pk_tee.into(),attestation_signature).await?;</span><br><br><br><span class="hljs-comment">// // TEE 2注册</span><br><span class="hljs-comment">//     let wallet2: LocalWallet = &quot;bafa3db5158993c5f009505a10d0f9c976624053f2cf89e0f303592c7a6a3ea6&quot;</span><br><span class="hljs-comment">//     .parse::&lt;LocalWallet&gt;()?</span><br><span class="hljs-comment">//     .with_chain_id(Chain::MoonbeamDev);</span><br><br><span class="hljs-comment">//     let client2 = SignerMiddleware::new(provider.clone(), wallet2.clone());</span><br><span class="hljs-comment">//     let pk_tee = Vec::&lt;u8&gt;::from_hex(&quot;00&quot;).expect(&quot;Failed to parse hex&quot;);</span><br><span class="hljs-comment">//     let attestation_signature = (&quot;6B273B5e911742Fa71259c6dd7B43411503A7258&quot;).parse::&lt;Bytes&gt;()?;</span><br><span class="hljs-comment">//     register_enclave(&amp;client2,&amp;contract_addr,pk_tee.into(),attestation_signature).await?;</span><br><br><span class="hljs-comment">// // TEE 3注册</span><br><span class="hljs-comment">//     let wallet3: LocalWallet = &quot;b00d0774b073b5bab993fe543f76045f19dcc4bf07358415c276de94ce0f8554&quot;</span><br><span class="hljs-comment">//         .parse::&lt;LocalWallet&gt;()?</span><br><span class="hljs-comment">//         .with_chain_id(Chain::MoonbeamDev);</span><br><span class="hljs-comment">//     let client3 = SignerMiddleware::new(provider.clone(), wallet3.clone());</span><br><span class="hljs-comment">//     let pk_tee = Vec::&lt;u8&gt;::from_hex(&quot;00&quot;).expect(&quot;Failed to parse hex&quot;);</span><br><span class="hljs-comment">//     let attestation_signature = (&quot;6B273B5e911742Fa71259c6dd7B43411503A7258&quot;).parse::&lt;Bytes&gt;()?;</span><br><span class="hljs-comment">//     register_enclave(&amp;client3,&amp;contract_addr,pk_tee.into(),attestation_signature).await?;</span><br><br><br><br><span class="hljs-comment">//2.查询现有的provider - 通过</span><br>    <span class="hljs-keyword">let</span> addr = <span class="hljs-string">&quot;0xcF01f9F4131aD4572BC99285170fF7bf44798382&quot;</span>.parse::&lt;Address&gt;()?;<br>    get_provide_byAddr(&amp;client1,&amp;contract_addr,addr).<span class="hljs-keyword">await</span>?;<br><br>    <span class="hljs-keyword">let</span> addr = <span class="hljs-string">&quot;0x4ed26b20D7c781d1AbF744A17a716C11d075e333&quot;</span>.parse::&lt;Address&gt;()?;<br>    get_provide_byAddr(&amp;client1,&amp;contract_addr,addr).<span class="hljs-keyword">await</span>?;<br><br>    <span class="hljs-keyword">let</span> addr = <span class="hljs-string">&quot;0xE2D41704668c31FF795C28D7B58143509316c8A4&quot;</span>.parse::&lt;Address&gt;()?;<br>    get_provide_byAddr(&amp;client1,&amp;contract_addr,addr).<span class="hljs-keyword">await</span>?;<br><br>    <span class="hljs-literal">Ok</span>(())<br><br>&#125;<br><br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">print_balances</span></span>(provider: &amp;Provider&lt;Http&gt;, address_from: Address, address_to: Address) -&gt; <span class="hljs-built_in">Result</span>&lt;(), <span class="hljs-built_in">Box</span>&lt;<span class="hljs-keyword">dyn</span> std::error::Error&gt;&gt; &#123;<br>    <span class="hljs-comment">// 2. Use the get_balance function</span><br>    <span class="hljs-keyword">let</span> balance_from = provider.get_balance(address_from, <span class="hljs-literal">None</span>).<span class="hljs-keyword">await</span>?;<br>    <span class="hljs-keyword">let</span> balance_to = provider.get_balance(address_to, <span class="hljs-literal">None</span>).<span class="hljs-keyword">await</span>?;<br><br>    <span class="hljs-comment">// 3. Print the resultant balance</span><br>    <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;&#123;&#125; has &#123;&#125;&quot;</span>, address_from, balance_from);<br>    <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;&#123;&#125; has &#123;&#125;&quot;</span>, address_to, balance_to);<br><br>    <span class="hljs-literal">Ok</span>(())<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20231113150510081.png" srcset="/img/loading.gif" lazyload alt="image-20231113150510081"></p>
<h5 id="rust-grpc调用成功"><a href="#rust-grpc调用成功" class="headerlink" title="rust-grpc调用成功"></a>rust-grpc调用成功</h5><blockquote>
<p>server在docker中跑</p>
<p>client在主机跑</p>
<p>通过 <a target="_blank" rel="noopener" href="http://[::1]:50051">http://[::1]:50051</a> 启动服务</p>
</blockquote>
<p><img src="/images/lab_test/image-20231116150205735.png" srcset="/img/loading.gif" lazyload alt="image-20231116150205735"></p>
<h5 id="测试函数的gas费和吞吐量时延"><a href="#测试函数的gas费和吞吐量时延" class="headerlink" title="测试函数的gas费和吞吐量时延"></a>测试函数的gas费和吞吐量时延</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> coordinator = artifacts.require(<span class="hljs-string">&#x27;COORDINATOR&#x27;</span>);<br><br>contract(<span class="hljs-string">&#x27;coordinator&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">accounts</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">let</span> instance;<br><span class="hljs-comment">// 定义共享的测试参数</span><br>    <span class="hljs-keyword">const</span> sharedSourceCode = <span class="hljs-string">&quot;test source code&quot;</span>;<br>    <span class="hljs-keyword">const</span> sharedM = <span class="hljs-number">123</span>;<br><br>  before(<span class="hljs-keyword">async</span> () =&gt; &#123;<br>    instance = <span class="hljs-keyword">await</span> coordinator.deployed();<br>  &#125;);<br><br>  <span class="hljs-comment">//测试 调用所需要的gas费</span><br>  it(<span class="hljs-string">&#x27;should estimate gas for a function call&#x27;</span>, <span class="hljs-keyword">async</span> () =&gt; &#123;<br>    <span class="hljs-keyword">const</span> gasEstimate = <span class="hljs-keyword">await</span> instance.deployContract.estimateGas(sharedSourceCode,sharedM);<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;Gas estimate for yourFunction:&#x27;</span>, gasEstimate);<br>  &#125;);<br><br>  <span class="hljs-comment">//吞吐量</span><br>  it(<span class="hljs-string">&#x27;should measure transaction execution frequency for a function call&#x27;</span>, <span class="hljs-keyword">async</span> () =&gt; &#123;<br>    <span class="hljs-keyword">const</span> startTime = <span class="hljs-built_in">Date</span>.now();<br><br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">Date</span>.now() - startTime &lt; <span class="hljs-number">10000</span>) &#123;<br>      <span class="hljs-comment">// Replace &#x27;yourFunction&#x27; with the actual function name in your contract</span><br>      <span class="hljs-keyword">await</span> instance.deployContract(sharedSourceCode,sharedM);<br>    &#125;<br><br>    <span class="hljs-keyword">const</span> endTime = <span class="hljs-built_in">Date</span>.now();<br>    <span class="hljs-keyword">const</span> executionTime = endTime - startTime;<br><br>    <span class="hljs-keyword">const</span> transactionsPerSecond = (executionTime / <span class="hljs-number">1000</span>);<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;Transactions per second for yourFunction:&#x27;</span>, transactionsPerSecond);<br>  &#125;);<br><br>  <span class="hljs-comment">//时延</span><br>  it(<span class="hljs-string">&#x27;should measure transaction confirmation time for a function call&#x27;</span>, <span class="hljs-keyword">async</span> () =&gt; &#123;<br>    <span class="hljs-keyword">const</span> startTime = <span class="hljs-built_in">Date</span>.now();<br><br>    <span class="hljs-comment">// Replace &#x27;yourFunction&#x27; with the actual function name in your contract</span><br>    <span class="hljs-keyword">const</span> tx = <span class="hljs-keyword">await</span> instance.deployContract(sharedSourceCode,sharedM);<br>    <span class="hljs-keyword">const</span> receipt = <span class="hljs-keyword">await</span> web3.eth.getTransactionReceipt(tx.tx);<br><br>    <span class="hljs-keyword">const</span> endTime = <span class="hljs-built_in">Date</span>.now();<br>    <span class="hljs-keyword">const</span> confirmationTime = endTime - startTime;<br><br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;Transaction confirmation time for yourFunction:&#x27;</span>, confirmationTime, <span class="hljs-string">&#x27;milliseconds&#x27;</span>);<br>  &#125;);<br>&#125;);<br><br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20231117103022766.png" srcset="/img/loading.gif" lazyload alt="image-20231117103022766"></p>
<h5 id="查询部署请求成功"><a href="#查询部署请求成功" class="headerlink" title="查询部署请求成功"></a>查询部署请求成功</h5><p><img src="/images/lab_test/image-20231117125131907.png" srcset="/img/loading.gif" lazyload alt="image-20231117125131907"></p>
<h5 id="docker内sgx函数与宿主机通信成功"><a href="#docker内sgx函数与宿主机通信成功" class="headerlink" title="docker内sgx函数与宿主机通信成功"></a>docker内sgx函数与宿主机通信成功</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs rust">server.rs<br><span class="hljs-keyword">use</span> tonic::&#123;transport::Server, Request, Response, Status&#125;;<br><br><span class="hljs-keyword">use</span> hello_world::greeter_server::&#123;Greeter, GreeterServer&#125;;<br><span class="hljs-keyword">use</span> hello_world::&#123;HelloReply, HelloRequest&#125;;<br><span class="hljs-keyword">use</span> std::process::Command;<br><span class="hljs-keyword">pub</span> <span class="hljs-keyword">mod</span> hello_world &#123;<br>    tonic::include_proto!(<span class="hljs-string">&quot;helloworld&quot;</span>);<br>&#125;<br><br><span class="hljs-meta">#[derive(Debug, Default)]</span><br><span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">MyGreeter</span></span> &#123;&#125;<br><br><span class="hljs-meta">#[tonic::async_trait]</span><br><span class="hljs-keyword">impl</span> Greeter <span class="hljs-keyword">for</span> MyGreeter &#123;<br>    <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">say_hello</span></span>(<br>        &amp;<span class="hljs-keyword">self</span>,<br>        request: Request&lt;HelloRequest&gt;,<br>    ) -&gt; <span class="hljs-built_in">Result</span>&lt;Response&lt;HelloReply&gt;, Status&gt; &#123;<br>        <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;Got a request: &#123;:?&#125;&quot;</span>, request);<br><br>        <span class="hljs-comment">// 执行外部命令</span><br>        <span class="hljs-keyword">let</span> executable_path = <span class="hljs-string">&quot;./app&quot;</span>;<br>        <span class="hljs-keyword">let</span> output = Command::new(executable_path)<br>            .current_dir(<span class="hljs-string">&quot;./bin&quot;</span>)<br>            <span class="hljs-comment">// .arg(&quot;argument1&quot;)</span><br>            <span class="hljs-comment">// .arg(&quot;argument2&quot;)</span><br>            .output()<br>            .expect(<span class="hljs-string">&quot;Failed to execute command&quot;</span>);<br><br>        <span class="hljs-comment">// let output = Command::new(&quot;pwd&quot;)</span><br>        <span class="hljs-comment">// // .arg(&quot;-l&quot;)</span><br>        <span class="hljs-comment">// .output()</span><br>        <span class="hljs-comment">// .expect(&quot;failed to execute process&quot;);</span><br><br>        <span class="hljs-keyword">let</span> stdout = <span class="hljs-built_in">String</span>::from_utf8_lossy(&amp;output.stdout);<br>        <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;111&#123;&#125;222&quot;</span>, stdout);<br><br>        <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;I am running your contract!&quot;</span>);<br><br>        <span class="hljs-keyword">let</span> reply = hello_world::HelloReply &#123;<br>            message: <span class="hljs-built_in">format!</span>(<span class="hljs-string">&quot;Hello &#123;&#125;! Your contract is exe succ!&quot;</span>, request.into_inner().name).into(),<br>        &#125;;<br><br>        <span class="hljs-literal">Ok</span>(Response::new(reply))<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">#[tokio::main]</span><br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span></span>() -&gt; <span class="hljs-built_in">Result</span>&lt;(), <span class="hljs-built_in">Box</span>&lt;<span class="hljs-keyword">dyn</span> std::error::Error&gt;&gt; &#123;<br>    <span class="hljs-keyword">let</span> addr = <span class="hljs-string">&quot;[::1]:50051&quot;</span>.parse()?;<br>    <span class="hljs-keyword">let</span> greeter = MyGreeter::default();<br><br>    Server::builder()<br>        .add_service(GreeterServer::new(greeter))<br>        .serve(addr)<br>        .<span class="hljs-keyword">await</span>?;<br><br>    <span class="hljs-literal">Ok</span>(())<br>&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20231117144936021.png" srcset="/img/loading.gif" lazyload alt="image-20231117144936021"></p>
<h5 id="合约部署确、sgx执行返回成功"><a href="#合约部署确、sgx执行返回成功" class="headerlink" title="合约部署确、sgx执行返回成功"></a>合约部署确、sgx执行返回成功</h5><p><img src="/images/lab_test/image-20231120154853899.png" srcset="/img/loading.gif" lazyload alt="image-20231120154853899"></p>
<p>测试链上三人poker 一轮 吞吐量</p>
<blockquote>
<p> Contract: TexasHoldemPoker<br>    ✔ should allow a player to join the game (93ms)<br>Total execution time: 877 ms<br>Average time per transaction: 87.7 ms<br>tps: 11.402508551881414<br>    ✔ should measure time for placeBet() function (1600ms)<br>Execution time for transaction : 51.71 ms<br>Gas used for transaction : 65371<br>Average gas used: 65371.00<br>    ✔ should measure time for placeBet() function (942ms)<br>Execution time for entire game: 583.73 ms<br>    ✔ should measure time for entire game (584ms)</p>
<p><img src="/images/lab_test/image-20231127200543999.png" srcset="/img/loading.gif" lazyload alt="image-20231127200543999"></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> TexasHoldemPoker = artifacts.require(<span class="hljs-string">&quot;TexasHoldemPoker&quot;</span>);<br><br>contract(<span class="hljs-string">&quot;TexasHoldemPoker&quot;</span>, <span class="hljs-keyword">async</span> (accounts) =&gt; &#123;<br>    <span class="hljs-keyword">let</span> pokerInstance;<br><br>    beforeEach(<span class="hljs-keyword">async</span> () =&gt; &#123;<br>        pokerInstance = <span class="hljs-keyword">await</span> TexasHoldemPoker.new(<span class="hljs-number">100</span>); <span class="hljs-comment">// 100为买入金额</span><br>    &#125;);<br><br>    it(<span class="hljs-string">&quot;should allow a player to join the game&quot;</span>, <span class="hljs-keyword">async</span> () =&gt; &#123;<br>        <span class="hljs-keyword">await</span> pokerInstance.joinGame(&#123; <span class="hljs-attr">from</span>: accounts[<span class="hljs-number">1</span>], <span class="hljs-attr">value</span>: <span class="hljs-number">100</span> &#125;);<br>        <span class="hljs-keyword">const</span> players = <span class="hljs-keyword">await</span> pokerInstance.getPlayers();<br><br>        assert.equal(players.length, <span class="hljs-number">1</span>, <span class="hljs-string">&quot;Player count should be 1.&quot;</span>);<br>    &#125;);<br><br>    <span class="hljs-comment">// it(&quot;should allow a player to place a bet&quot;, async () =&gt; &#123;</span><br>    <span class="hljs-comment">//     await pokerInstance.joinGame(&#123; from: accounts[1], value: 100 &#125;);</span><br>    <span class="hljs-comment">//     await pokerInstance.placeBet(&#123; from: accounts[1], value: 50 &#125;);</span><br>    <span class="hljs-comment">//     const pot = await pokerInstance.pot();</span><br><br>    <span class="hljs-comment">//     assert.equal(pot, 50, &quot;Pot should be 50.&quot;);</span><br>    <span class="hljs-comment">// &#125;);</span><br><br>    it(<span class="hljs-string">&quot;should measure time for placeBet() function&quot;</span>, <span class="hljs-keyword">async</span> () =&gt; &#123;<br>       <br>        <span class="hljs-keyword">const</span> numberOfTransactions = <span class="hljs-number">10</span>; <span class="hljs-comment">// 设置要执行的交易数量</span><br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; numberOfTransactions; i++) &#123;<br>            <span class="hljs-keyword">await</span> pokerInstance.joinGame(&#123; <span class="hljs-attr">from</span>: accounts[i], <span class="hljs-attr">value</span>: <span class="hljs-number">100</span> &#125;);<br>        &#125;<br><br>        <span class="hljs-keyword">const</span> startTime = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();<br>        <span class="hljs-keyword">await</span> pokerInstance.startBettingPhase(&#123; <span class="hljs-attr">from</span>: accounts[<span class="hljs-number">0</span>] &#125;); <span class="hljs-comment">// 在测试中手动开始下注阶段</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; numberOfTransactions; i++) &#123;<br>            <span class="hljs-keyword">await</span> pokerInstance.placeBet(&#123; <span class="hljs-attr">from</span>: accounts[i], <span class="hljs-attr">value</span>: <span class="hljs-number">50</span> &#125;);<br>        &#125;<br><br>        <span class="hljs-keyword">const</span> endTime = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime();<br>        <span class="hljs-keyword">const</span> executionTime = endTime - startTime;<br>        <span class="hljs-keyword">const</span> averageTimePerTx = executionTime / numberOfTransactions;<br>        <span class="hljs-keyword">const</span> tps =  numberOfTransactions / executionTime ;<br><br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Total execution time: <span class="hljs-subst">$&#123;executionTime&#125;</span> ms`</span>);<br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Average time per transaction: <span class="hljs-subst">$&#123;averageTimePerTx&#125;</span> ms`</span>);<br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`tps: <span class="hljs-subst">$&#123;tps * <span class="hljs-number">1000</span>&#125;</span> `</span>);<br>    &#125;);<br><br>    it(<span class="hljs-string">&quot;should measure time for placeBet() function&quot;</span>, <span class="hljs-keyword">async</span> () =&gt; &#123;<br> <br>        <span class="hljs-keyword">const</span> gasUsed = [];<br><br>        <span class="hljs-keyword">const</span> numberOfTransactions = <span class="hljs-number">10</span>; <span class="hljs-comment">// 设置要执行的交易数量</span><br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; numberOfTransactions; i++) &#123;<br>            <span class="hljs-keyword">await</span> pokerInstance.joinGame(&#123; <span class="hljs-attr">from</span>: accounts[i], <span class="hljs-attr">value</span>: <span class="hljs-number">100</span> &#125;);<br>        &#125;<br>        <br>        <span class="hljs-keyword">await</span> pokerInstance.startBettingPhase(&#123; <span class="hljs-attr">from</span>: accounts[<span class="hljs-number">0</span>] &#125;); <span class="hljs-comment">// 在测试中手动开始下注阶段</span><br>        <br>        <span class="hljs-keyword">const</span> startTime = performance.now();<br>        <span class="hljs-keyword">const</span> tx = <span class="hljs-keyword">await</span> pokerInstance.placeBet(&#123; <span class="hljs-attr">from</span>: accounts[<span class="hljs-number">1</span>], <span class="hljs-attr">value</span>: <span class="hljs-number">50</span> &#125;);<br>        <span class="hljs-keyword">const</span> endTime = performance.now();<br><br>        <span class="hljs-keyword">const</span> executionTime = endTime - startTime;<br>        gasUsed.push(tx.receipt.gasUsed);<br><br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Execution time for transaction : <span class="hljs-subst">$&#123;executionTime.toFixed(<span class="hljs-number">2</span>)&#125;</span> ms`</span>);<br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Gas used for transaction : <span class="hljs-subst">$&#123;tx.receipt.gasUsed&#125;</span>`</span>);<br><br>        <span class="hljs-comment">// 输出平均 Gas 消耗</span><br>        <span class="hljs-keyword">const</span> totalGasUsed = gasUsed.reduce(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a + b, <span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">const</span> averageGasUsed = totalGasUsed / gasUsed.length;<br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Average gas used: <span class="hljs-subst">$&#123;averageGasUsed.toFixed(<span class="hljs-number">2</span>)&#125;</span>`</span>);<br>    &#125;);<br><br><br><br>    it(<span class="hljs-string">&quot;should measure time for entire game&quot;</span>, <span class="hljs-keyword">async</span> () =&gt; &#123;<br>        <span class="hljs-keyword">const</span> account1 = accounts[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">const</span> account2 = accounts[<span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">const</span> account3 = accounts[<span class="hljs-number">2</span>];<br>        <span class="hljs-keyword">const</span> amount = <span class="hljs-number">50</span>; <span class="hljs-comment">// 下注金额</span><br>       <br>        <span class="hljs-keyword">const</span> startTime = performance.now();<br>        <span class="hljs-comment">// 玩家1加入游戏并开始下注阶段</span><br>        <span class="hljs-keyword">await</span> pokerInstance.joinGame(&#123; <span class="hljs-attr">from</span>: account1, <span class="hljs-attr">value</span>: <span class="hljs-number">100</span> &#125;);<br>        <span class="hljs-keyword">await</span> pokerInstance.joinGame(&#123; <span class="hljs-attr">from</span>: account2, <span class="hljs-attr">value</span>: <span class="hljs-number">100</span> &#125;);<br>        <span class="hljs-keyword">await</span> pokerInstance.joinGame(&#123; <span class="hljs-attr">from</span>: account3, <span class="hljs-attr">value</span>: <span class="hljs-number">100</span> &#125;);<br>        <span class="hljs-keyword">await</span> pokerInstance.startBettingPhase(&#123; <span class="hljs-attr">from</span>: account1 &#125;);<br><br>        <br>        <span class="hljs-keyword">await</span> pokerInstance.placeBet(&#123; <span class="hljs-attr">from</span>: account1, <span class="hljs-attr">value</span>: amount &#125;);<br>        <span class="hljs-keyword">await</span> pokerInstance.placeBet(&#123; <span class="hljs-attr">from</span>: account2, <span class="hljs-attr">value</span>: amount &#125;);<br>        <span class="hljs-keyword">await</span> pokerInstance.placeBet(&#123; <span class="hljs-attr">from</span>: account3, <span class="hljs-attr">value</span>: amount &#125;);<br><br>        <span class="hljs-keyword">await</span> pokerInstance.startShowdownPhase(&#123; <span class="hljs-attr">from</span>: account1 &#125;);<br>        <span class="hljs-comment">// 模拟下注阶段结束</span><br>        <span class="hljs-keyword">await</span> pokerInstance.declareWinner(&#123; <span class="hljs-attr">from</span>: accounts[<span class="hljs-number">0</span>] &#125;); <span class="hljs-comment">// 在测试中手动结束下注阶段</span><br><br>        <span class="hljs-keyword">const</span> endTime = performance.now();<br>        <span class="hljs-keyword">const</span> executionTime = endTime - startTime;<br><br>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Execution time for entire game: <span class="hljs-subst">$&#123;executionTime.toFixed(<span class="hljs-number">2</span>)&#125;</span> ms`</span>);<br>    &#125;);<br>&#125;);<br><br></code></pre></td></tr></table></figure>
<h5 id="从链上获取合约调用事件-暂时不写"><a href="#从链上获取合约调用事件-暂时不写" class="headerlink" title="从链上获取合约调用事件 - 暂时不写"></a>从链上获取合约调用事件 - 暂时不写</h5><p>outsourcer </p>
<p>对应 1 重放攻击，不同输入多次运行</p>
<p>对应2 提供修改后、延迟、虚假的环境数据给tee </p>
<p>丢弃、延迟输出，关闭服务</p>
<p>与client合谋</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs solidity">   bytes32 constant WRAPPER_PROGRAM_CODE_HASH = keccak256(abi.encode(0));                  //0x290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e563<br>     address public constant ATTESTATION_AUTHORITY = 0x1dF62f291b2E969fB0849d99D9Ce41e2F137006e;<br>  <br>bytes32 attestationHash = keccak256(abi.encode(&quot;Pose-Attest&quot;, WRAPPER_PROGRAM_CODE_HASH, teeSignatureAddress, teeEncryptionKey));        <br>//TODO: After the testing we should include the manager-address here as well: keccak256(abi.encode(&quot;Furious-Attest&quot;, WRAPPER_PROGRAM_CODE_HASH,  address(this), teeSignatureAddress, teeEncryptionKey)); <br> require(verifySignature(attestationHash, attestationSignature, ATTESTATION_AUTHORITY), &quot;Wrong attestation&quot;);<br><br>链下<br>att_hash = Web3.keccak(encode_abi([&#x27;string&#x27;, &#x27;bytes32&#x27;, &#x27;address&#x27;, &#x27;bytes&#x27;],<br>            [&#x27;Furious-Attest&#x27;,<br>             Web3.toBytes(hexstr=&#x27;0x290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e563&#x27;),<br>             tee1_addr,<br>             Web3.toBytes(hexstr=&#x27;0x00&#x27;)]))message = messages.encode_defunct(att_hash) <br>sig = w3.eth.account.sign_message(message, priv_key)<br>encoded_sig = encode_abi([&quot;uint8&quot;,&quot;bytes32&quot;,&quot;bytes32&quot;],<br>                         [sig.v, Web3.toBytes(sig.r), Web3.toBytes(sig.s)])<br>print(f&#x27;TEE 1 encoded_sig: &#123;encoded_sig.hex()&#125;&#x27;)<br><br># send out registration tx to solidity contract<br>tx_hash = contract.functions.register(tee1_addr, &quot;0x00&quot;, encoded_sig).transact(&#123;&#x27;from&#x27;: tee1_addr&#125;)<br> <br> <br> function verifySignature(bytes32 _hashedDataInput, bytes memory _signature, address _party) public pure returns (bool)&#123;<br><br>        //Convert signatures<br>        (uint8 v, bytes32 r, bytes32 s) = abi.decode(_signature, (uint8, bytes32, bytes32));<br><br>        //Calc prefixed hash<br>        bytes32 _hash = keccak256(abi.encodePacked(&quot;\x19Ethereum Signed Message:\n32&quot;, _hashedDataInput));<br><br>        return _party == ecrecover(_hash, v,r,s);<br><br>    &#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/lab_test/image-20231129101652934.png" srcset="/img/loading.gif" lazyload alt="image-20231129101652934"></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">note:</span> <span class="hljs-string">to</span> <span class="hljs-string">see</span> <span class="hljs-string">what</span> <span class="hljs-string">the</span> <span class="hljs-string">problems</span> <span class="hljs-string">were,</span> <span class="hljs-string">use</span> <span class="hljs-string">the</span> <span class="hljs-string">option</span> <span class="hljs-string">`--future-incompat-report`,</span> <span class="hljs-string">or</span> <span class="hljs-string">run</span> <span class="hljs-string">`cargo</span> <span class="hljs-string">report</span> <span class="hljs-string">future-incompatibilities</span> <span class="hljs-string">--id</span> <span class="hljs-number">1</span><span class="hljs-string">`</span><br>     <span class="hljs-string">Running</span> <span class="hljs-string">`/home/yumohan/lab/pet/target/debug/main`</span><br><span class="hljs-number">0x7301</span><span class="hljs-string">…b727</span> <span class="hljs-string">has</span> <span class="hljs-number">88282204019999996083</span><br><span class="hljs-number">0xd81c</span><span class="hljs-string">…a101</span> <span class="hljs-string">has</span> <span class="hljs-number">99800029219999994574</span><br><span class="hljs-string">hhhhhhhh</span><br><span class="hljs-attr">Transaction Receipt register_enclave :</span> <span class="hljs-string">Some(</span><br>    <span class="hljs-string">TransactionReceipt</span> &#123;<br>        <span class="hljs-attr">transaction_hash:</span> <span class="hljs-number">0x338c5839ba79504baaeb0c9b3adf0f1cd1fa11c33926930485129bf55d3746bd</span>,<br>        <span class="hljs-attr">transaction_index:</span> <span class="hljs-number">0</span>,<br>        <span class="hljs-attr">block_hash:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0x561c1205add3db57b95af3c067dffacecd49e6d20947d6f9326bf9a0c98e4b11</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">block_number:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">13626</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">from:</span> <span class="hljs-number">0x7301de6116096af3d3bce50869229862e221b727</span>,<br>        <span class="hljs-attr">to:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0xb11b662dc12a07ab72739a04d0323000d7ab87a1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">cumulative_gas_used:</span> <span class="hljs-number">114704</span>,<br>        <span class="hljs-attr">gas_used:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">114704</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">contract_address:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs:</span> [<br>            <span class="hljs-string">Log</span> &#123;<br>                <span class="hljs-attr">address:</span> <span class="hljs-number">0xb11b662dc12a07ab72739a04d0323000d7ab87a1</span>,<br>                <span class="hljs-attr">topics:</span> [<br>                    <span class="hljs-number">0x3ac461748dd21b3c9c3faa9c85712c1a04cd3eebcfee2a026acaaa82b1094ec0</span>,<br>                ],<br>                <span class="hljs-attr">data:</span> <span class="hljs-string">Bytes(0x0000000000000000000000007301de6116096af3d3bce50869229862e221b727)</span>,<br>                <span class="hljs-attr">block_hash:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0x561c1205add3db57b95af3c067dffacecd49e6d20947d6f9326bf9a0c98e4b11</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">block_number:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">13626</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_hash:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0x338c5839ba79504baaeb0c9b3adf0f1cd1fa11c33926930485129bf55d3746bd</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_index:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">log_index:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_log_index:</span> <span class="hljs-string">None</span>,<br>                <span class="hljs-attr">log_type:</span> <span class="hljs-string">None</span>,<br>                <span class="hljs-attr">removed:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-literal">false</span>,<br>                <span class="hljs-string">)</span>,<br>            &#125;,<br>        ],<br>        <span class="hljs-attr">status:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">root:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs_bloom:</span> <span class="hljs-number">0x00000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000020000000000000000000000000000000000000000000000004000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000</span>,<br>        <span class="hljs-attr">transaction_type:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">effective_gas_price:</span> <span class="hljs-string">None</span>,<br>    &#125;<span class="hljs-string">,</span><br><span class="hljs-string">)</span><br><span class="hljs-string">hhhhhhhh</span><br><span class="hljs-attr">Transaction Receipt register_enclave :</span> <span class="hljs-string">Some(</span><br>    <span class="hljs-string">TransactionReceipt</span> &#123;<br>        <span class="hljs-attr">transaction_hash:</span> <span class="hljs-number">0x0989abc479cd762386a881cb6f9b3f8af2210a51c27d55655f591f33d0338591</span>,<br>        <span class="hljs-attr">transaction_index:</span> <span class="hljs-number">0</span>,<br>        <span class="hljs-attr">block_hash:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0x9963ee9f9208a951a0e7e29162e416acba701b25fe502518bbdb31bda95087a3</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">block_number:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">13627</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">from:</span> <span class="hljs-number">0xd81cbe6d135e8fd95a5e0f32a453b1c82c56a101</span>,<br>        <span class="hljs-attr">to:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0xb11b662dc12a07ab72739a04d0323000d7ab87a1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">cumulative_gas_used:</span> <span class="hljs-number">99704</span>,<br>        <span class="hljs-attr">gas_used:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">99704</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">contract_address:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs:</span> [<br>            <span class="hljs-string">Log</span> &#123;<br>                <span class="hljs-attr">address:</span> <span class="hljs-number">0xb11b662dc12a07ab72739a04d0323000d7ab87a1</span>,<br>                <span class="hljs-attr">topics:</span> [<br>                    <span class="hljs-number">0x3ac461748dd21b3c9c3faa9c85712c1a04cd3eebcfee2a026acaaa82b1094ec0</span>,<br>                ],<br>                <span class="hljs-attr">data:</span> <span class="hljs-string">Bytes(0x000000000000000000000000d81cbe6d135e8fd95a5e0f32a453b1c82c56a101)</span>,<br>                <span class="hljs-attr">block_hash:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0x9963ee9f9208a951a0e7e29162e416acba701b25fe502518bbdb31bda95087a3</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">block_number:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">13627</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_hash:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0x0989abc479cd762386a881cb6f9b3f8af2210a51c27d55655f591f33d0338591</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_index:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">log_index:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_log_index:</span> <span class="hljs-string">None</span>,<br>                <span class="hljs-attr">log_type:</span> <span class="hljs-string">None</span>,<br>                <span class="hljs-attr">removed:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-literal">false</span>,<br>                <span class="hljs-string">)</span>,<br>            &#125;,<br>        ],<br>        <span class="hljs-attr">status:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">root:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs_bloom:</span> <span class="hljs-number">0x00000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000020000000000000000000000000000000000000000000000004000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000</span>,<br>        <span class="hljs-attr">transaction_type:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">effective_gas_price:</span> <span class="hljs-string">None</span>,<br>    &#125;<span class="hljs-string">,</span><br><span class="hljs-string">)</span><br><span class="hljs-string">hhhhhhhh</span><br><span class="hljs-attr">Transaction Receipt register_enclave :</span> <span class="hljs-string">Some(</span><br>    <span class="hljs-string">TransactionReceipt</span> &#123;<br>        <span class="hljs-attr">transaction_hash:</span> <span class="hljs-number">0x40f0336d685e9d58f059d51ed9114978256d030df3d049074c06734dafe7854d</span>,<br>        <span class="hljs-attr">transaction_index:</span> <span class="hljs-number">0</span>,<br>        <span class="hljs-attr">block_hash:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0x7edf293a1db09e53dca8e0b068a658aba315134a62c6abb508657158290ed3a6</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">block_number:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">13628</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">from:</span> <span class="hljs-number">0x45cc8ed997afa0b2e70130f23ff8f9516f82cddc</span>,<br>        <span class="hljs-attr">to:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0xb11b662dc12a07ab72739a04d0323000d7ab87a1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">cumulative_gas_used:</span> <span class="hljs-number">99704</span>,<br>        <span class="hljs-attr">gas_used:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">99704</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">contract_address:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs:</span> [<br>            <span class="hljs-string">Log</span> &#123;<br>                <span class="hljs-attr">address:</span> <span class="hljs-number">0xb11b662dc12a07ab72739a04d0323000d7ab87a1</span>,<br>                <span class="hljs-attr">topics:</span> [<br>                    <span class="hljs-number">0x3ac461748dd21b3c9c3faa9c85712c1a04cd3eebcfee2a026acaaa82b1094ec0</span>,<br>                ],<br>                <span class="hljs-attr">data:</span> <span class="hljs-string">Bytes(0x00000000000000000000000045cc8ed997afa0b2e70130f23ff8f9516f82cddc)</span>,<br>                <span class="hljs-attr">block_hash:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0x7edf293a1db09e53dca8e0b068a658aba315134a62c6abb508657158290ed3a6</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">block_number:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">13628</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_hash:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0x40f0336d685e9d58f059d51ed9114978256d030df3d049074c06734dafe7854d</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_index:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">log_index:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_log_index:</span> <span class="hljs-string">None</span>,<br>                <span class="hljs-attr">log_type:</span> <span class="hljs-string">None</span>,<br>                <span class="hljs-attr">removed:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-literal">false</span>,<br>                <span class="hljs-string">)</span>,<br>            &#125;,<br>        ],<br>        <span class="hljs-attr">status:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">root:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs_bloom:</span> <span class="hljs-number">0x00000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000020000000000000000000000000000000000000000000000004000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000</span>,<br>        <span class="hljs-attr">transaction_type:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">effective_gas_price:</span> <span class="hljs-string">None</span>,<br>    &#125;<span class="hljs-string">,</span><br><span class="hljs-string">)</span><br><br><span class="hljs-string">---------------------------------查询已注册provider------------------------</span><br><br><span class="hljs-attr">Eid:</span> [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<br><span class="hljs-attr">Initialized:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">Tee Signature Address:</span> <span class="hljs-number">0x7301</span><span class="hljs-string">…b727</span><br><span class="hljs-attr">Pk Tee:</span> <span class="hljs-string">Bytes(0x00)</span><br><span class="hljs-attr">Eid:</span> [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<br><span class="hljs-attr">Initialized:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">Tee Signature Address:</span> <span class="hljs-number">0xd81c</span><span class="hljs-string">…a101</span><br><span class="hljs-attr">Pk Tee:</span> <span class="hljs-string">Bytes(0x00)</span><br><span class="hljs-attr">Eid:</span> [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<br><span class="hljs-attr">Initialized:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">Tee Signature Address:</span> <span class="hljs-number">0x45cc</span><span class="hljs-string">…cddc</span><br><span class="hljs-attr">Pk Tee:</span> <span class="hljs-string">Bytes(0x00)</span><br><span class="hljs-attr">Transaction Receipt contract_deploy :</span> <span class="hljs-string">Some(</span><br>    <span class="hljs-string">TransactionReceipt</span> &#123;<br>        <span class="hljs-attr">transaction_hash:</span> <span class="hljs-number">0x3ebb44762e563e1ada6c2060e3591ec6c9ad3b1cd672291cc3d2a4650102d59c</span>,<br>        <span class="hljs-attr">transaction_index:</span> <span class="hljs-number">0</span>,<br>        <span class="hljs-attr">block_hash:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0x665701676101094e4636eaeed280dbb763d00a2a598a0bafa86cd4e11547b0c0</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">block_number:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">13629</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">from:</span> <span class="hljs-number">0x613a7bcacec7f0a751bcab3181d85351f740fed5</span>,<br>        <span class="hljs-attr">to:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0xb11b662dc12a07ab72739a04d0323000d7ab87a1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">cumulative_gas_used:</span> <span class="hljs-number">233240</span>,<br>        <span class="hljs-attr">gas_used:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">233240</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">contract_address:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs:</span> [<br>            <span class="hljs-string">Log</span> &#123;<br>                <span class="hljs-attr">address:</span> <span class="hljs-number">0xb11b662dc12a07ab72739a04d0323000d7ab87a1</span>,<br>                <span class="hljs-attr">topics:</span> [<br>                    <span class="hljs-number">0x18597f5749abff03066cd54db949ca5d98ceb74d2ad73a7358b9aceff6f0bac4</span>,<br>                ],<br>                <span class="hljs-attr">data:</span> <span class="hljs-string">Bytes(0x000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000084eb07bb570000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000107465737420736f7572636520636f64650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000)</span>,<br>                <span class="hljs-attr">block_hash:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0x665701676101094e4636eaeed280dbb763d00a2a598a0bafa86cd4e11547b0c0</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">block_number:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">13629</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_hash:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0x3ebb44762e563e1ada6c2060e3591ec6c9ad3b1cd672291cc3d2a4650102d59c</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_index:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">log_index:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_log_index:</span> <span class="hljs-string">None</span>,<br>                <span class="hljs-attr">log_type:</span> <span class="hljs-string">None</span>,<br>                <span class="hljs-attr">removed:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-literal">false</span>,<br>                <span class="hljs-string">)</span>,<br>            &#125;,<br>        ],<br>        <span class="hljs-attr">status:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">root:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs_bloom:</span> <span class="hljs-number">0x00000000000000000000000010000000000000000000000000000000000000000000000000080000200000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000020000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span>,<br>        <span class="hljs-attr">transaction_type:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">effective_gas_price:</span> <span class="hljs-string">None</span>,<br>    &#125;<span class="hljs-string">,</span><br><span class="hljs-string">)</span><br><span class="hljs-attr">Total time elapsed:</span> <span class="hljs-number">7</span><br><br><span class="hljs-string">---------------------------------查询链上部署请求------------------------</span><br><br><span class="hljs-attr">deploy_id:</span> <span class="hljs-number">1</span><br><span class="hljs-attr">deploy_req:</span> <span class="hljs-number">0x613a</span><span class="hljs-string">…fed5</span><br><span class="hljs-attr">codehash:</span> [<span class="hljs-number">48</span>, <span class="hljs-number">141</span>, <span class="hljs-number">34</span>, <span class="hljs-number">175</span>, <span class="hljs-number">240</span>, <span class="hljs-number">250</span>, <span class="hljs-number">216</span>, <span class="hljs-number">21</span>, <span class="hljs-number">94</span>, <span class="hljs-number">31</span>, <span class="hljs-number">0</span>, <span class="hljs-number">168</span>, <span class="hljs-number">115</span>, <span class="hljs-number">177</span>, <span class="hljs-number">120</span>, <span class="hljs-number">0</span>, <span class="hljs-number">22</span>, <span class="hljs-number">155</span>, <span class="hljs-number">214</span>, <span class="hljs-number">161</span>, <span class="hljs-number">5</span>, <span class="hljs-number">70</span>, <span class="hljs-number">127</span>, <span class="hljs-number">64</span>, <span class="hljs-number">16</span>, <span class="hljs-number">200</span>, <span class="hljs-number">62</span>, <span class="hljs-number">12</span>, <span class="hljs-number">58</span>, <span class="hljs-number">134</span>, <span class="hljs-number">43</span>, <span class="hljs-number">242</span>]<br><span class="hljs-attr">m:</span> <span class="hljs-number">5</span><br><br><span class="hljs-string">---------------------------------查询链上已有合约------------------------</span><br><br><span class="hljs-attr">pahse:</span> <span class="hljs-number">1</span><br><span class="hljs-attr">cid:</span> <span class="hljs-number">1</span><br><span class="hljs-attr">pk_cid:</span> <span class="hljs-string">Bytes(0x)</span><br><span class="hljs-attr">p_count:</span> <span class="hljs-number">0</span><br><span class="hljs-attr">codehash:</span> <span class="hljs-number">0x308d22aff0fad8155e1f00a873b17800169bd6a105467f4010c83e0c3a862bf2</span><br><span class="hljs-attr">reqAddr:</span> <span class="hljs-number">0x613a7bcacec7f0a751bcab3181d85351f740fed5</span><br><span class="hljs-attr">Transaction Receipt deploy_confirm:</span> <span class="hljs-string">Some(</span><br>    <span class="hljs-string">TransactionReceipt</span> &#123;<br>        <span class="hljs-attr">transaction_hash:</span> <span class="hljs-number">0xdb799bc69ed0eb4ba5b7263e6c49f7f7a2cf060aa8f0af458de31eb3c2f6d4ca</span>,<br>        <span class="hljs-attr">transaction_index:</span> <span class="hljs-number">0</span>,<br>        <span class="hljs-attr">block_hash:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0x9bf42bf1465f9931ddb445099a08d41ec2a080db6392b1d3826417497606fa17</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">block_number:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">13630</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">from:</span> <span class="hljs-number">0x7301de6116096af3d3bce50869229862e221b727</span>,<br>        <span class="hljs-attr">to:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0xb11b662dc12a07ab72739a04d0323000d7ab87a1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">cumulative_gas_used:</span> <span class="hljs-number">137770</span>,<br>        <span class="hljs-attr">gas_used:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">137770</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">contract_address:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs:</span> [],<br>        <span class="hljs-attr">status:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">root:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs_bloom:</span> <span class="hljs-number">0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span>,<br>        <span class="hljs-attr">transaction_type:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">effective_gas_price:</span> <span class="hljs-string">None</span>,<br>    &#125;<span class="hljs-string">,</span><br><span class="hljs-string">)</span><br><span class="hljs-attr">Transaction Receipt deploy_confirm:</span> <span class="hljs-string">Some(</span><br>    <span class="hljs-string">TransactionReceipt</span> &#123;<br>        <span class="hljs-attr">transaction_hash:</span> <span class="hljs-number">0xe9d44312cab217bef29be842c47773cf501987b7bb4d55ba7de8b4cb96a389b0</span>,<br>        <span class="hljs-attr">transaction_index:</span> <span class="hljs-number">0</span>,<br>        <span class="hljs-attr">block_hash:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0x56b1b9151ab1e2be2a55e8a71a3f579535b1c0db94a0a43a3fd7e17c3139d45d</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">block_number:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">13631</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">from:</span> <span class="hljs-number">0xd81cbe6d135e8fd95a5e0f32a453b1c82c56a101</span>,<br>        <span class="hljs-attr">to:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0xb11b662dc12a07ab72739a04d0323000d7ab87a1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">cumulative_gas_used:</span> <span class="hljs-number">84678</span>,<br>        <span class="hljs-attr">gas_used:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">84678</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">contract_address:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs:</span> [],<br>        <span class="hljs-attr">status:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">root:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs_bloom:</span> <span class="hljs-number">0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span>,<br>        <span class="hljs-attr">transaction_type:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">effective_gas_price:</span> <span class="hljs-string">None</span>,<br>    &#125;<span class="hljs-string">,</span><br><span class="hljs-string">)</span><br><span class="hljs-attr">Transaction Receipt deploy_confirm:</span> <span class="hljs-string">Some(</span><br>    <span class="hljs-string">TransactionReceipt</span> &#123;<br>        <span class="hljs-attr">transaction_hash:</span> <span class="hljs-number">0x2a7fb008901ba36f7151fcf50ef8732e584f6e5c9e8fe9bfee83315f895db49b</span>,<br>        <span class="hljs-attr">transaction_index:</span> <span class="hljs-number">0</span>,<br>        <span class="hljs-attr">block_hash:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0x6fb21f0c3f7fe2f6270a6f8110410e06ee82875b5e4c63af49b93d1dc6742764</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">block_number:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">13632</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">from:</span> <span class="hljs-number">0x45cc8ed997afa0b2e70130f23ff8f9516f82cddc</span>,<br>        <span class="hljs-attr">to:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0xb11b662dc12a07ab72739a04d0323000d7ab87a1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">cumulative_gas_used:</span> <span class="hljs-number">58700</span>,<br>        <span class="hljs-attr">gas_used:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">58700</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">contract_address:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs:</span> [<br>            <span class="hljs-string">Log</span> &#123;<br>                <span class="hljs-attr">address:</span> <span class="hljs-number">0xb11b662dc12a07ab72739a04d0323000d7ab87a1</span>,<br>                <span class="hljs-attr">topics:</span> [<br>                    <span class="hljs-number">0xb6500999f71b2b47b3a0a1277f9d5f63a1b7c1c05f7c1b2f5f141ddb4c32d8cd</span>,<br>                ],<br>                <span class="hljs-attr">data:</span> <span class="hljs-string">Bytes(0x000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000144411108da00000000000000000000000045cc8ed997afa0b2e70130f23ff8f9516f82cddc0000000000000000000000000000000000000000000000000000000000000001010101010101010101010101010101010101010101010101010101010101010100000000000000000000000000000000000000000000000000000000000000c0308d22aff0fad8155e1f00a873b17800169bd6a105467f4010c83e0c3a862bf2000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000204f3edf983ac636a65a842ce7c78d9aa706d3b113bce9c46f30d7d21715b23b1d00000000000000000000000000000000000000000000000000000000000000146b273b5e911742fa71259c6dd7b43411503a725800000000000000000000000000000000000000000000000000000000000000000000000000000000)</span>,<br>                <span class="hljs-attr">block_hash:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0x6fb21f0c3f7fe2f6270a6f8110410e06ee82875b5e4c63af49b93d1dc6742764</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">block_number:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">13632</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_hash:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0x2a7fb008901ba36f7151fcf50ef8732e584f6e5c9e8fe9bfee83315f895db49b</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_index:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">log_index:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_log_index:</span> <span class="hljs-string">None</span>,<br>                <span class="hljs-attr">log_type:</span> <span class="hljs-string">None</span>,<br>                <span class="hljs-attr">removed:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-literal">false</span>,<br>                <span class="hljs-string">)</span>,<br>            &#125;,<br>        ],<br>        <span class="hljs-attr">status:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">root:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs_bloom:</span> <span class="hljs-number">0x00000000000001000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000400000000020000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span>,<br>        <span class="hljs-attr">transaction_type:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">effective_gas_price:</span> <span class="hljs-string">None</span>,<br>    &#125;<span class="hljs-string">,</span><br><span class="hljs-string">)</span><br><br><span class="hljs-string">---------------------------------请求执行合约------------------------</span><br><br><span class="hljs-attr">Transaction Receipt contract_call:</span> <span class="hljs-string">Some(</span><br>    <span class="hljs-string">TransactionReceipt</span> &#123;<br>        <span class="hljs-attr">transaction_hash:</span> <span class="hljs-number">0x8ba90b528de2d08b4f9139858284110225986a9c7dc6b537d2a92ea72fbe685e</span>,<br>        <span class="hljs-attr">transaction_index:</span> <span class="hljs-number">0</span>,<br>        <span class="hljs-attr">block_hash:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0xcb44f0d8ff7d7994ebf5b680f3d53d26f6d6a088ade49f6c0808250abbde5e99</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">block_number:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">13633</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">from:</span> <span class="hljs-number">0x613a7bcacec7f0a751bcab3181d85351f740fed5</span>,<br>        <span class="hljs-attr">to:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0xb11b662dc12a07ab72739a04d0323000d7ab87a1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">cumulative_gas_used:</span> <span class="hljs-number">146328</span>,<br>        <span class="hljs-attr">gas_used:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">146328</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">contract_address:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs:</span> [<br>            <span class="hljs-string">Log</span> &#123;<br>                <span class="hljs-attr">address:</span> <span class="hljs-number">0xb11b662dc12a07ab72739a04d0323000d7ab87a1</span>,<br>                <span class="hljs-attr">topics:</span> [<br>                    <span class="hljs-number">0x4989f1e758cf33244ccc3dad475b2b1683e26feca64d0c548c06ba81fb645cee</span>,<br>                ],<br>                <span class="hljs-attr">data:</span> <span class="hljs-string">Bytes(0x00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000849f60b5c1000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000001110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000)</span>,<br>                <span class="hljs-attr">block_hash:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0xcb44f0d8ff7d7994ebf5b680f3d53d26f6d6a088ade49f6c0808250abbde5e99</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">block_number:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">13633</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_hash:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0x8ba90b528de2d08b4f9139858284110225986a9c7dc6b537d2a92ea72fbe685e</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_index:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">log_index:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_log_index:</span> <span class="hljs-string">None</span>,<br>                <span class="hljs-attr">log_type:</span> <span class="hljs-string">None</span>,<br>                <span class="hljs-attr">removed:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-literal">false</span>,<br>                <span class="hljs-string">)</span>,<br>            &#125;,<br>        ],<br>        <span class="hljs-attr">status:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">root:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs_bloom:</span> <span class="hljs-number">0x00000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span>,<br>        <span class="hljs-attr">transaction_type:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">effective_gas_price:</span> <span class="hljs-string">None</span>,<br>    &#125;<span class="hljs-string">,</span><br><span class="hljs-string">)</span><br><br><span class="hljs-string">---------------------------------查根据请求执行合约</span> <span class="hljs-string">sgx返回结果------------------------</span><br><br><br><span class="hljs-string">---------------------------------返回执行结果到链上------------------------</span><br><br><span class="hljs-attr">Transaction Receipt contract_execution_result:</span> <span class="hljs-string">Some(</span><br>    <span class="hljs-string">TransactionReceipt</span> &#123;<br>        <span class="hljs-attr">transaction_hash:</span> <span class="hljs-number">0xe038e97f4915d8ac86d31f75b1110c89aaa5301bff748a84e690543c693d86ed</span>,<br>        <span class="hljs-attr">transaction_index:</span> <span class="hljs-number">0</span>,<br>        <span class="hljs-attr">block_hash:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0xad2748b3c2f317ebe4fd38262622cda180d2a771b133794265368a5b0c301487</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">block_number:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">13634</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">from:</span> <span class="hljs-number">0x45cc8ed997afa0b2e70130f23ff8f9516f82cddc</span>,<br>        <span class="hljs-attr">to:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">0xb11b662dc12a07ab72739a04d0323000d7ab87a1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">cumulative_gas_used:</span> <span class="hljs-number">33879</span>,<br>        <span class="hljs-attr">gas_used:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">33879</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">contract_address:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs:</span> [<br>            <span class="hljs-string">Log</span> &#123;<br>                <span class="hljs-attr">address:</span> <span class="hljs-number">0xb11b662dc12a07ab72739a04d0323000d7ab87a1</span>,<br>                <span class="hljs-attr">topics:</span> [<br>                    <span class="hljs-number">0xc219b7b4c8e7b822aa88a66db4b3637eccdc5539c68005d1fa34ead4c9d0de6b</span>,<br>                ],<br>                <span class="hljs-attr">data:</span> <span class="hljs-string">Bytes(0x00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001848c187ecb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000045cc8ed997afa0b2e70130f23ff8f9516f82cddc00000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000)</span>,<br>                <span class="hljs-attr">block_hash:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0xad2748b3c2f317ebe4fd38262622cda180d2a771b133794265368a5b0c301487</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">block_number:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">13634</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_hash:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0xe038e97f4915d8ac86d31f75b1110c89aaa5301bff748a84e690543c693d86ed</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_index:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">log_index:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-number">0</span>,<br>                <span class="hljs-string">)</span>,<br>                <span class="hljs-attr">transaction_log_index:</span> <span class="hljs-string">None</span>,<br>                <span class="hljs-attr">log_type:</span> <span class="hljs-string">None</span>,<br>                <span class="hljs-attr">removed:</span> <span class="hljs-string">Some(</span><br>                    <span class="hljs-literal">false</span>,<br>                <span class="hljs-string">)</span>,<br>            &#125;,<br>        ],<br>        <span class="hljs-attr">status:</span> <span class="hljs-string">Some(</span><br>            <span class="hljs-number">1</span>,<br>        <span class="hljs-string">)</span>,<br>        <span class="hljs-attr">root:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">logs_bloom:</span> <span class="hljs-number">0x00000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000</span>,<br>        <span class="hljs-attr">transaction_type:</span> <span class="hljs-string">None</span>,<br>        <span class="hljs-attr">effective_gas_price:</span> <span class="hljs-string">None</span>,<br>    &#125;<span class="hljs-string">,</span><br><span class="hljs-string">)</span><br></code></pre></td></tr></table></figure>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>lab测试</div>
      <div>https://yuwxl.github.io/2023/09/10/lab_test/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>nayun</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年9月10日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/09/10/forOC/" title="forOC">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">forOC</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/08/16/KZG/" title="KZG">
                        <span class="hidden-mobile">KZG</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
